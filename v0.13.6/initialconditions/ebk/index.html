<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Semiclassical EBK quantisation · NQCDynamics.jl</title><meta name="title" content="Semiclassical EBK quantisation · NQCDynamics.jl"/><meta property="og:title" content="Semiclassical EBK quantisation · NQCDynamics.jl"/><meta property="twitter:title" content="Semiclassical EBK quantisation · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/ebk/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/ebk/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/ebk/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li class="is-active"><a class="tocitem" href>Semiclassical EBK quantisation</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-13-1" type="checkbox"/><label class="tocitem" for="menuitem-13-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-2" type="checkbox"/><label class="tocitem" for="menuitem-13-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-3" type="checkbox"/><label class="tocitem" for="menuitem-13-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-4" type="checkbox"/><label class="tocitem" for="menuitem-13-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Initial conditions</a></li><li class="is-active"><a href>Semiclassical EBK quantisation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Semiclassical EBK quantisation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/initialconditions/ebk.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ebk-sampling"><a class="docs-heading-anchor" href="#ebk-sampling">Semiclassical EBK quantisation</a><a id="ebk-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#ebk-sampling" title="Permalink"></a></h1><p>In surface science, it is often of interest to investigate how collisions with surfaces can perturb the quantum states of molecules. In particular, for diatomic molecules, the rotational and vibrational quantum numbers can undergo significant changes when the molecule impacts the surface.</p><p>Einstein-Brillouinn-Keller (EBK) quantisation allows for a semiclassical investigation into these phenomena by providing a link between the quantum numbers and classical positions and velocities. The quantisation procedure allows the user to generate a classical distribution with a given set of quantum numbers, then perform semiclassical dynamics and extract the quantum numbers at the end by reversing the procedure.</p><p>These three steps can be applied to give insight into the processes taking place during surface scattering and allow us to attempt to predict the experimentally observed change in the quantum numbers.</p><p>A detailed yet approachable description of the theory is given by [<a href="../../references/#Larkoski2006">4</a>] so we shall not delve into the theory here. Briefly, the procedure for a diatomic molecule involves an optimisation process to find the bounds of an integral, then computing the integral to obtain the vibrational quantum number. The rotational quantum number comes directly from the classical angular momentum of the molecule.</p><p>Configurations can be generated by randomly selecting bond lengths from the appropriate probability distribution and selecting a matching radial velocity.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>In this example we will create a quantised distribution suitable for use as initial conditions for hydrogen scattering simulations.</p><p>The simulation can be set up in the usual way, by specifying the atoms along with the model and the simulation cell.</p><pre><code class="language-julia hljs">using NQCDynamics
using Unitful, UnitfulAtomic

atoms = Atoms([:H, :H])
model = DiatomicHarmonic()
cell = PeriodicCell(austrip.([5.883 -2.942 0; 0 5.095 0; 0 0 20] .* u&quot;Å&quot;))
sim = Simulation(atoms, model; cell=cell)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Simulation{Classical}:
  Atoms{Float64}([:H, :H], [1, 1], [1837.4715941070515, 1837.4715941070515])
  DiatomicHarmonic
  r₀: Float64 1.0
</code></pre><p>The distribution is generated using the <a href="../../api/NQCDynamics/initialconditions/#NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations-Tuple{Any, Any, Any}"><code>QuantisedDiatomic.generate_configurations</code></a> function. We have to provide the desired vibrational <code>ν</code> and rotational <code>J</code> quantum numbers, along with the number of samples and some other options as keyword arguments. In addition to the rotational and vibrational energy we have applied a translational impulse of 1 eV and positioned the molecule at a height of 10 bohr.</p><pre><code class="language-julia hljs">using NQCDynamics.InitialConditions: QuantisedDiatomic

ν, J = 2, 0
nsamples = 150

configurations = QuantisedDiatomic.generate_configurations(sim, ν, J;
    samples=nsamples, translational_energy=1u&quot;eV&quot;, height=10)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">150-element Vector{Tuple{Matrix{Float64}, Matrix{Float64}}}:
 ([-0.0017065845706450455 0.0017065845706450455; -0.0012309391475201798 0.0012309391475201798; 0.0014835629496075618 -0.010427821509106544], [1.5469915553669698 1.2402287597590955; 5.172986008519258 4.951721653613168; 9.464724799027362 10.535275200972638])
 ([-0.003671481987511133 0.003671481987511133; 0.0006398543763918291 -0.0006398543763918291; -9.176936956798235e-5 -0.008852489189931], [-2.2331517508774246 -1.7277644788545787; 9.082925709733702 8.994848399569433; 10.301482909764399 9.698517090235601])
 ([0.0017200034697995319 -0.0017200034697995319; -0.0005466174884177667 0.0005466174884177667; -0.0006328174859201677 -0.008311441073578814], [4.529897468138888 4.807884666376406; 4.279685754751744 4.191341360812473; 9.689744948929881 10.310255051070119])
 ([-0.003201642327034053 0.003201642327034053; 0.0022912418330926763 -0.0022912418330926763; -0.00673180389627716 -0.0022124546632218225], [-0.7060190997036414 -1.621995634775002; 4.560129810082349 5.215644555613278; 10.323241748173844 9.676758251826156])
 ([0.0005002622648817872 -0.0005002622648817872; -2.6661005621027343e-5 2.6661005621027343e-5; -0.005137764961235074 -0.0038064935982639082], [1.91262996084064 2.2711235292188547; 7.840289935434991 7.821184358795322; 10.23850100981734 9.76149899018266])
 ([-0.0005408972254336332 0.0005408972254336332; -0.0005509004339772271 0.0005509004339772271; -0.004159107065339626 -0.004785151494159356], [5.838829502140775 6.226442540508558; 7.143013148272916 7.537794598447398; 10.11215762061522 9.88784237938478])
 ([0.0002513667323669415 -0.0002513667323669415; 0.0022539875960111136 -0.0022539875960111136; -0.0069604660005094954 -0.001983792558989487], [2.5854132826599905 2.5369693773865984; 6.905058764421659 6.470665714234068; 9.760221356156169 10.239778643843831])
 ([0.005726337445400868 -0.005726337445400868; -0.0019151265393312989 0.0019151265393312989; -0.002996749136118022 -0.00594750942338096], [4.9980182186334545 4.216390307336992; 8.094856582538453 8.356265619480242; 10.100692485470022 9.899307514529978])
 ([0.0032889998836047487 -0.0032889998836047487; -0.0022908946784383414 0.0022908946784383414; 0.0007310076691442327 -0.009675266228643214], [6.116918659814077 6.657822173906167; 1.2025175686498326 0.8257607958207458; 9.572150325393988 10.427849674606012])
 ([-0.002194043368012765 0.002194043368012765; 0.0057347308759614435 -0.0057347308759614435; -0.004868569854207722 -0.00407568870529126], [5.144866087934475 4.845588645166793; 3.689035823263031 4.4712790626357855; 10.027038144063823 9.972961855936177])
 ⋮
 ([-0.0025747865725515664 0.0025747865725515664; 0.0029446324731708805 -0.0029446324731708805; -0.006972423126740783 -0.001971835432758199], [-2.572524964721242 -2.964733693511116; 6.664181836803911 7.1127279692747045; 10.190430749053853 9.809569250946147])
 ([-0.002985384408183397 0.002985384408183397; -0.0007934346729096454 0.0007934346729096454; -0.00022098751621685026 -0.008723271043282133], [3.626674306177805 4.051653639186378; 6.198832265236662 6.311780312112877; 10.302582037046669 9.697417962953331])
 ([-0.00548991466275513 0.00548991466275513; 0.002770579020130641 -0.002770579020130641; -0.005959794459947968 -0.0029844640995510137], [6.1579804857059965 7.141649255898148; 4.881211614551576 4.384786401252475; 9.866721992220446 10.133278007779554])
 ([-0.0023525741459385005 0.0023525741459385005; -0.00031814244266696894 0.00031814244266696894; 0.0014372218408286938 -0.010381480400327676], [4.963171382746785 4.547153701825173; 4.265874613700502 4.209615863501472; 9.477509656140136 10.522490343859864])
 ([-0.0019280046049512576 0.0019280046049512576; -3.965308000344372e-5 3.965308000344372e-5; -0.006361890472861008 -0.0025823680866379735], [3.4769277863472 3.0282782393508954; 6.75333026615311 6.744102935297745; 10.219875124012505 9.780124875987495])
 ([0.0024023574508907513 -0.0024023574508907513; 0.0011920819364943502 -0.0011920819364943502; -0.00415973397682249 -0.004784524582676492], [4.791683202798938 4.23265104110315; 1.1398153327640268 0.8624160882719788; 10.036347426448579 9.963652573551421])
 ([-0.0012143578458732847 0.0012143578458732847; 0.0029970959739554644 -0.0029970959739554644; -0.0044843938613335806 -0.004459864698165401], [-1.9669061486578863 -1.4578097056239279; 9.45567316581559 8.199197650828602; 9.997429153654757 10.002570846345243])
 ([-0.0006645611949418996 0.0006645611949418996; -0.0027315630203000422 0.0027315630203000422; 0.000512682919575339 -0.009456941479074322], [8.112430677100663 8.253077002641716; 1.8283177879630559 2.4064200074623523; 10.527487554707838 9.472512445292162])
 ([0.00027326712543831013 -0.00027326712543831013; -0.006633023193412784 0.006633023193412784; -0.005194079730356331 -0.003750178829142651], [4.7131868061085065 4.755453521175086; 1.051452050462454 0.025510489082475885; 10.05583268375046 9.94416731624954])</code></pre><p>The output contains both the positions and velocities, these can be passed directly to the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a> for use with dynamics. Here however, let&#39;s focus on the positions and visualise the distribution.</p><p>This collects the x and y coordinate for each atom:</p><pre><code class="language-julia hljs">r = last.(configurations)
x = hcat([i[1,:] for i in r]...)
y = hcat([i[2,:] for i in r]...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×150 Matrix{Float64}:
 5.17299  9.08293  4.27969  4.56013  7.84029  …  9.45567  1.82832  1.05145
 4.95172  8.99485  4.19134  5.21564  7.82118     8.1992   2.40642  0.0255105</code></pre><p>Now we can plot the distribution:</p><pre><code class="language-julia hljs">using Plots

plt = plot(
    xlabel=&quot;x coordinate / bohr&quot;,
    ylabel=&quot;y coordinate / bohr&quot;,
    legend=false,
)

for i=1:nsamples
    plot!([x[1,i], x[2,i]], [y[1,i], y[2,i]], linewidth=5, color=:black)
    scatter!([x[1,i], x[2,i]], [y[1,i], y[2,i]])
end
plt</code></pre><img src="9433a610.svg" alt="Example block output"/><p>Here we can see that the molecule is randomly distributed within the unit cell. Since we have used a harmonic potential, this could have been produced without using the EBK procedure, but this technique can use any arbitrary potential. In the <a href="../../examples/reactive_scattering/#example-h2scattering">hydrogen scattering example</a> we build on this example and use the sample procedure to perform scattering simulations starting from this distribution.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../NQCDistributions/overview/">« NQCDistributions.jl</a><a class="docs-footer-nextpage" href="../hamiltonian/">Thermal Hamiltonian Monte Carlo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 11 April 2024 16:16">Thursday 11 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
