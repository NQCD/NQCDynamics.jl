<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>RingPolymerArrays · NQCDynamics.jl</title><meta name="title" content="RingPolymerArrays · NQCDynamics.jl"/><meta property="og:title" content="RingPolymerArrays · NQCDynamics.jl"/><meta property="twitter:title" content="RingPolymerArrays · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/RingPolymerArrays/ringpolymerarrays/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/RingPolymerArrays/ringpolymerarrays/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/api/RingPolymerArrays/ringpolymerarrays/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../../NQCModels/machinelearningmodels/">Machine learning interatomic potentials</a></li><li><a class="tocitem" href="../../../NQCModels/fullsizemodels/">Full dimensional model library</a></li><li><a class="tocitem" href="../../../NQCModels/frictionmodels/">Electronic friction models</a></li><li><a class="tocitem" href="../../../NQCModels/systembathmodels/">System-bath models</a></li></ul></li><li><span class="tocitem">NQCCalculators.jl</span><ul><li><a class="tocitem" href="../../../NQCCalculators/overview/">NQCCalculators.jl</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/iesh/">Independent electron surface hopping (IESH)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../../NQCRecipes/overview/">NQCRecipes</a></li><li><a class="tocitem" href="../../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-16-1" type="checkbox"/><label class="tocitem" for="menuitem-16-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-2" type="checkbox"/><label class="tocitem" for="menuitem-16-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCModels/FrictionProviders/">FrictionModels</a></li><li><a class="tocitem" href="../../NQCModels/adiabaticmodels/">ClassicalModels</a></li><li><a class="tocitem" href="../../NQCModels/bathdiscretisations/">BathDiscretisations</a></li><li><a class="tocitem" href="../../NQCModels/diabaticmodels/">QuantumModels</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">FrictionProviders.jl</a></li><li><a class="tocitem" href="../../NQCModels/mace/">MACEModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-3" type="checkbox"/><label class="tocitem" for="menuitem-16-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-4" type="checkbox"/><label class="tocitem" for="menuitem-16-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../../NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-5" type="checkbox"/><label class="tocitem" for="menuitem-16-5"><span class="docs-label">NQCCalculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCCalculators/nqccalculators/">NQCCalculators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-6" type="checkbox"/><label class="tocitem" for="menuitem-16-6"><span class="docs-label">NQCDInterfASE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCDInterfASE/ase-interface/">NQCDInterfASE</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-16-7" type="checkbox" checked/><label class="tocitem" for="menuitem-16-7"><span class="docs-label">RingPolymerArrays</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>RingPolymerArrays</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">RingPolymerArrays</a></li><li class="is-active"><a href>RingPolymerArrays</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>RingPolymerArrays</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/api/RingPolymerArrays/ringpolymerarrays.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="RingPolymerArrays"><a class="docs-heading-anchor" href="#RingPolymerArrays">RingPolymerArrays</a><a id="RingPolymerArrays-1"></a><a class="docs-heading-anchor-permalink" href="#RingPolymerArrays" title="Permalink"></a></h1><p>RingPolymerArrays.jl provides the <code>RingPolymerArray{T}</code>, an <code>AbstractArray{T,3}</code>, useful for representing ring polymer systems using the imaginary-time path integral formalism.</p><p>A <code>RingPolymerArray</code> can be used to store positions or momenta for ring polymer systems, where the three dimensions represent each degree of freedom per atom, each atom and each ring polymer bead.</p><p>For example, this <code>RingPolymerArray</code> represents a 3D system with 2 atoms, and 4 ring polymer beads:</p><pre><code class="language-julia hljs">julia&gt; RingPolymerArray(reshape(1:24, 3, 2, 4))
3×2×4 RingPolymerArray{Int64}:
[:, :, 1] =
 1  4
 2  5
 3  6

[:, :, 2] =
 7  10
 8  11
 9  12

[:, :, 3] =
 13  16
 14  17
 15  18

[:, :, 4] =
 19  22
 20  23
 21  24</code></pre><p>In a system with disparate particle masses, it is desirable to treat heavier atoms classically, without any replicas. This is made possible by the <code>classical</code> keyword argument in the constructor that allows us to specify which atoms should be treated classically. Here, the first atom will have a fixed value for all beads:</p><pre><code class="language-julia hljs">julia&gt; a = RingPolymerArray{Float64}(reshape(1:24, 3, 2, 4); classical=[1])
3×2×4 RingPolymerArray{Float64}:
[:, :, 1] =
 1.0  4.0
 2.0  5.0
 3.0  6.0

[:, :, 2] =
 1.0  10.0
 2.0  11.0
 3.0  12.0

[:, :, 3] =
 1.0  16.0
 2.0  17.0
 3.0  18.0

[:, :, 4] =
 1.0  22.0
 2.0  23.0
 3.0  24.0</code></pre><p>These values will remain fixed, even after attempted modification:</p><pre><code class="language-julia hljs">julia&gt; a .+= rand(3, 2, 4)
3×2×4 RingPolymerArray{Float64}:
[:, :, 1] =
 1.78368  4.85881
 2.90528  5.81841
 3.57008  6.31728

[:, :, 2] =
 1.78368  10.6239
 2.90528  11.9604
 3.57008  12.4336

[:, :, 3] =
 1.78368  16.1968
 2.90528  17.8464
 3.57008  18.8612

[:, :, 4] =
 1.78368  22.7994
 2.90528  23.1735
 3.57008  24.7504
 ```
 This works by internally storing only a single copy of the classical positions and allowing `setindex!` to operate only on the first bead for atoms labelled as classical.
 
## Normal mode transformation

Alongside the `RingPolymerArray` we also provide the `NormalModeTransformation{T}` which can be used to convert any `AbstractArray{T,3}` of ring polymer coordinates to and from normal mode coordinates:</code></pre><p>julia julia&gt; transform = NormalModeTransformation{Float64}(4);</p><p>julia&gt; transform<em>to</em>normal_modes!(fill(1.0, (2,3,4)), transform) 2×3×4 Array{Float64, 3}: [:, :, 1] =  2.0  2.0  2.0  2.0  2.0  2.0</p><p>[:, :, 2] =  -8.65956e-17  -8.65956e-17  -8.65956e-17  -8.65956e-17  -8.65956e-17  -8.65956e-17</p><p>[:, :, 3] =  0.0  0.0  0.0  0.0  0.0  0.0</p><p>[:, :, 4] =  2.59787e-16  2.59787e-16  2.59787e-16  2.59787e-16  2.59787e-16  2.59787e-16</p><p>julia&gt; transform<em>from</em>normal_modes!(fill(1.0, (2,3,4)), transform) 2×3×4 Array{Float64, 3}: [:, :, 1] =  1.70711  1.70711  1.70711  1.70711  1.70711  1.70711</p><p>[:, :, 2] =  -0.707107  -0.707107  -0.707107  -0.707107  -0.707107  -0.707107</p><p>[:, :, 3] =  0.292893  0.292893  0.292893  0.292893  0.292893  0.292893</p><p>[:, :, 4] =  0.707107  0.707107  0.707107  0.707107  0.707107  0.707107</p><pre><code class="nohighlight hljs">When using a `RingPolymerArray`, the normal mode transformation is applied to both classical
and quantum atoms, where the classical atoms will have the value of the scaled centroid.
In normal mode coordinates, the centroid is given by the first bead coordinate divided by `sqrt(nbeads)`.

# API
</code></pre><p>@autodocs Modules=[RingPolymerArrays]</p><pre><code class="nohighlight hljs"></code></pre><p>@setup logging runtime = round(time() - start_time; digits=2) @info &quot;...done after runtime s.&quot; ```</p><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../NQCDInterfASE/ase-interface/">« NQCDInterfASE</a><a class="docs-footer-nextpage" href="../../../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 23 July 2025 22:30">Wednesday 23 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
