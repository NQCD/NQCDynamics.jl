<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time-dependent populations with the ThreeStateMorse model · NQCDynamics.jl</title><meta name="title" content="Time-dependent populations with the ThreeStateMorse model · NQCDynamics.jl"/><meta property="og:title" content="Time-dependent populations with the ThreeStateMorse model · NQCDynamics.jl"/><meta property="twitter:title" content="Time-dependent populations with the ThreeStateMorse model · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/examples/threestatemorse/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/examples/threestatemorse/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/examples/threestatemorse/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li class="is-active"><a class="tocitem" href>Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Time-dependent populations with the ThreeStateMorse model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time-dependent populations with the ThreeStateMorse model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/examples/threestatemorse.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-dependent-populations-with-the-ThreeStateMorse-model"><a class="docs-heading-anchor" href="#Time-dependent-populations-with-the-ThreeStateMorse-model">Time-dependent populations with the ThreeStateMorse model</a><a id="Time-dependent-populations-with-the-ThreeStateMorse-model-1"></a><a class="docs-heading-anchor-permalink" href="#Time-dependent-populations-with-the-ThreeStateMorse-model" title="Permalink"></a></h1><p>In this example we investigate the time-dependent populations of the three state morse model parametrised to describe photodissociation processes ([<a href="../../references/#Coronado2001">23</a>]). This reference introduces three versions of this model with different parameter sets. Our <code>ThreeStateMorse</code> model matches model C from the reference.</p><p>First let&#39;s visualise the diabats and couplings for the model. You can see two regions where the diabats cross with non-zero coupling where we can expect to see population transfer.</p><pre><code class="language-julia hljs">using NQCDynamics
using Plots

x = range(2, 12, length=200)
model = ThreeStateMorse()
V = potential.(model, x)

plot(
    xlabel=&quot;Nuclear coordinate /a.u.&quot;,
    ylabel=&quot;Potential energy /a.u.&quot;,
    legend=true,
    xlims=(2, 12),
    ylims=(0, 0.06)
)

plot!(x, [v[1,1] for v in V], label=&quot;State 1&quot;)
plot!(x, [v[2,2] for v in V], label=&quot;State 2&quot;)
plot!(x, [v[3,3] for v in V], label=&quot;State 3&quot;)

plot!(x, [v[1,2] for v in V], label=&quot;Coupling 12&quot;)
plot!(x, [v[2,3] for v in V], label=&quot;Coupling 23&quot;)
plot!(x, [v[1,3] for v in V], label=&quot;Coupling 13&quot;)</code></pre><img src="092313dd.svg" alt="Example block output"/><p>To this model we can apply any of the methods capable of starting the population on a single diabatic state and returning the population as a function of time. Here, let&#39;s use <code>FSSH</code> and <code>Ehrenfest</code>. We can expect the nuclear quantum effects here to be minimal since the nuclear mass is chosen to be 20000. </p><pre><code class="language-julia hljs">m = 20000
atoms = Atoms(m)</code></pre><p>For our initial conditions, we use the Wigner distribution for a Harmonic oscillator centred at 2.1 with a frequency of 5e-3 at a temperature of 300 K. This distribution is chosen to mimic a thermal ground state distribution before photoexcitation.</p><pre><code class="language-julia hljs">using Distributions: Normal
using Unitful, UnitfulAtomic

ω = 5e-3
β = 1/austrip(300u&quot;K&quot;)
position = PositionHarmonicWigner(ω, β, m; centre=2.1)
velocity = VelocityHarmonicWigner(ω, β, m)
distribution = DynamicalDistribution(velocity, position, (1,1)) * PureState(1)</code></pre><p>Now let&#39;s run the two simulations using Ehrenfest and FSSH. For both simulations we use the same initial distribution and average the results using <code>reduction=:mean</code>. <a href="../../api/NQCDynamics/timecorrelationfunctions/#NQCDynamics.TimeCorrelationFunctions.PopulationCorrelationFunction"><code>TimeCorrelationFunctions.PopulationCorrelationFunction</code></a> will correlate the intial population with the final population at each timestep.</p><pre><code class="language-julia hljs">sim = Simulation{FSSH}(atoms, model)
fssh_result = run_dynamics(sim, (0.0, 3000.0), distribution;
    saveat=10, trajectories=50,
    output=TimeCorrelationFunctions.PopulationCorrelationFunction(sim, Diabatic()),
    reduction=MeanReduction(), dt=1.0)
sim = Simulation{Ehrenfest}(atoms, model)
ehrenfest_result = run_dynamics(sim, (0.0, 3000.0), distribution;
    saveat=10, trajectories=50,
    output=TimeCorrelationFunctions.PopulationCorrelationFunction(sim, Diabatic()),
    reduction=MeanReduction(), dt=1.0)

plot(
    xlabel=&quot;Time /a.u.&quot;,
    ylabel=&quot;Population&quot;
)

x = 0:10:3000
y = [p[1,1] for p in fssh_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;FSSH State 1&quot;, color=:red)
y = [p[1,2] for p in fssh_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;FSSH State 2&quot;, color=:green)
y = [p[1,3] for p in fssh_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;FSSH State 3&quot;, color=:blue)

y = [p[1,1] for p in ehrenfest_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;Ehrenfest State 1&quot;, color=:red, linestyle=:dash)
y = [p[1,2] for p in ehrenfest_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;Ehrenfest State 2&quot;, color=:green, linestyle=:dash)
y = [p[1,3] for p in ehrenfest_result[:PopulationCorrelationFunction]]
plot!(x, y, label=&quot;Ehrenfest State 3&quot;, color=:blue, linestyle=:dash)</code></pre><img src="64d498c5.svg" alt="Example block output"/><p>To reduce the build time for the documentation the results here are underconverged but already it is clear that both of these methods come close to the exact result shown by [<a href="../../references/#Coronado2001">23</a>]. After performing enough trajectories to converge the population dynamics, we would be better able to judge the effectiveness of FSSH and Ehrenfest at reproducing the exact quantum dynamics for this model.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spinboson/">« Ohmic spin-boson nonequilibrium population dynamics</a><a class="docs-footer-nextpage" href="../tully_scattering/">Scattering probabilities for TullyModelTwo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 16 August 2024 14:25">Friday 16 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
