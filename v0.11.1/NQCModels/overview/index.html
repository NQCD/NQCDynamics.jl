<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NQCModels.jl · NQCDynamics.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/NQCModels/overview/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li class="is-active"><a class="tocitem" href>NQCModels.jl</a></li><li><a class="tocitem" href="../analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../ase/">ASE interface</a></li><li><a class="tocitem" href="../neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-13-1" type="checkbox"/><label class="tocitem" for="menuitem-13-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-2" type="checkbox"/><label class="tocitem" for="menuitem-13-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-3" type="checkbox"/><label class="tocitem" for="menuitem-13-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-13-4" type="checkbox"/><label class="tocitem" for="menuitem-13-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">NQCModels.jl</a></li><li class="is-active"><a href>NQCModels.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>NQCModels.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/NQCModels/overview.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="NQCModels.jl"><a class="docs-heading-anchor" href="#NQCModels.jl">NQCModels.jl</a><a id="NQCModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#NQCModels.jl" title="Permalink"></a></h1><p>To perform nonadiabatic molecular dynamics simulations, it is necessary to define the system Hamiltonian. For simple models, this often comes in the form of small matrix in the diabatic representation but equally the electronic Hamiltonian could be obtained directly from <em>ab initio</em> electronic structure theory.</p><p><code>NQCModels.jl</code> is a package that aims to provide a common interface for defining these models that is flexible enough to allow for a wide range of specifications and requirements. <code>NQCDynamics.jl</code> uses this interface to obtain the potentials and couplings necessary to perform the dynamics simulations. Along with the minimal interface, <code>NQCModels.jl</code> also provides a small set of popular models often used in the field of nonadiabatic dynamics.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Taking advantages of Julia&#39;s seamless modularity, <code>NQCModels.jl</code> is designed as a separate package so that it can also be used independently from the main package.</p></div></div><p>Depending on the quantities provided by the <code>Model</code>, we use Julia&#39;s abstract type system to group models that provide the same quantities. Currently, there are two top-level abstract types: <a href="../../api/NQCModels/adiabaticmodels/#NQCModels.AdiabaticModels.AdiabaticModel"><code>AdiabaticModel</code></a> and <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DiabaticModel"><code>DiabaticModel</code></a>. The <a href="../../api/NQCModels/adiabaticmodels/#NQCModels.AdiabaticModels.AdiabaticModel"><code>AdiabaticModel</code></a> is used for adiabatic dynamics, providing only the potential and force used in classical mechanics. The <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DiabaticModel"><code>DiabaticModel</code></a> is used for nonadiabatic dynamics,  where the potential is instead a <code>Hermitian</code> matrix.</p><p>In the <a href="../../getting_started/#Getting-started">Getting started</a> section we briefly touched on how the <a href="../../api/NQCModels/adiabaticmodels/#NQCModels.AdiabaticModels.AdiabaticModel"><code>AdiabaticModel</code></a> works and introduced one of the included models. Here let&#39;s take a look at a <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DiabaticModel"><code>DiabaticModel</code></a>, which is more appropriate for nonadiabatic dynamics.</p><p>The <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DoubleWell"><code>DoubleWell</code></a> is a two state, 1 dimensional model where each state is harmonic with linear coupling to the single degree of freedom.</p><pre><code class="language-julia hljs">using NQCModels

model = DoubleWell()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DoubleWell{Int64, Int64, Int64, Int64}
  mass: Int64 1
  ω: Int64 1
  γ: Int64 1
  Δ: Int64 1
</code></pre><p>Our <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DoubleWell"><code>DoubleWell</code></a> implements the functions <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.potential-Tuple{NQCModels.Model, AbstractMatrix}"><code>potential</code></a>, <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.derivative-Tuple{NQCModels.Model, Any}"><code>derivative</code></a>, <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.nstates-Tuple{NQCModels.Model}"><code>nstates</code></a> and <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.ndofs-Tuple{NQCModels.Model}"><code>ndofs</code></a> that return the potential, the derivative of the potential, the number of states, and the number of degrees of freedom, respectively.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; potential(model, 0.2)</code><code class="nohighlight hljs ansi" style="display:block;">2×2 LinearAlgebra.Hermitian{Float64, StaticArrays.SMatrix{2, 2, Float64, 4}}:
 0.302843   0.5
 0.5       -0.262843</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; derivative(model, 0.2)</code><code class="nohighlight hljs ansi" style="display:block;">2×2 LinearAlgebra.Hermitian{Float64, StaticArrays.SMatrix{2, 2, Float64, 4}}:
 1.61421   0.0
 0.0      -1.21421</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nstates(model)</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ndofs(model)</code><code class="nohighlight hljs ansi" style="display:block;">1</code></pre><p>Since this is a 1D model, the position argument that appears in the derivative and the potential is a real number. For higher dimensional models with multiple atoms, the position will need to be provided as an <code>AbstractMatrix</code>.</p><p>To understand how this can extend to another dimension, we can take a quick look at the <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.GatesHollowayElbow"><code>GatesHollowayElbow</code></a> model which is another two state diabatic model, but this one uses two dimensions to model a diatomic molecule interacting with a surface. The two coordinates are the molecular bond length and the distance from the surface. Technically, the model has been defined such that there are two atoms, each with only a single degree of freedom. This allows us to use different masses for each of the coordinates when performing dynamics.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; model = GatesHollowayElbow()</code><code class="nohighlight hljs ansi" style="display:block;">GatesHollowayElbow
  λ₁: Float64 3.5
  λ₂: Float64 3.5
  z₀: Float64 1.4
  x₀: Float64 0.6
  α: Float64 1.028
  d: Float64 0.17161933455967185
  z12: Float64 0.5
  c: Float64 0.0183746610877593
  γ: Float64 1.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; potential(model, [1.0 1.0])</code><code class="nohighlight hljs ansi" style="display:block;">2×2 LinearAlgebra.Hermitian{Float64, StaticArrays.SMatrix{2, 2, Float64, 4}}:
 0.0710215  0.0111448
 0.0111448  0.0744945</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; derivative(model, [1.0 1.0])</code><code class="nohighlight hljs ansi" style="display:block;">1×2 Matrix{LinearAlgebra.Hermitian{Float64, StaticArrays.SMatrix{2, 2, Float64, 4}}}:
 [0.0810696 0.0; 0.0 -0.0129425]  …  [-0.000787036 -0.0111448; -0.0111448 0.0810696]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nstates(model)</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ndofs(model)</code><code class="nohighlight hljs ansi" style="display:block;">1</code></pre><p>Here we see how the derivative now becomes a <code>Matrix</code> with size matching our input, but each entry is a <code>Hermitian</code> containing the elementwise derivative of the potential with respect to each degree of freedom. In this case, the <code>Matrix</code> has <code>size = (1, 2)</code>, but it should be clear how this can extend to arbitrary numbers of atoms and degrees of freedom for complex models.</p><p>The models currently available can be seen in type tree of the <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.Model"><code>Model</code></a> below. The leaves of the tree are the concrete models, whereas each branch is one of the abstract types. Each of these models can be seen in the <a href="../analyticmodels/#Analytic-model-library">Analytic model library</a> and many shall return later when we investigate the dynamics methods.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Model
├─ AdiabaticModel
│  ├─ AdiabaticASEModel
│  ├─ AveragedPotential
│  ├─ BosonBath
│  ├─ DarlingHollowayElbow
│  ├─ DiatomicHarmonic
│  ├─ Free
│  ├─ Harmonic
│  ├─ Morse
│  └─ AdiabaticFrictionModel
│     ├─ CompositeFrictionModel
│     ├─ H2AgModel
│     └─ LDFAModel
└─ DiabaticModel
   ├─ DoubleWell
   ├─ ErpenbeckThoss
   ├─ GatesHollowayElbow
   ├─ AnanthModel
   │  ├─ AnanthModelOne
   │  └─ AnanthModelTwo
   ├─ LargeDiabaticModel
   │  ├─ MiaoSubotnik
   │  └─ DiabaticFrictionModel
   │     ├─ OuyangModelOne
   │     ├─ Scattering1D
   │     └─ WideBandBath
   ├─ TullyModel
   │  ├─ TullyModelOne
   │  ├─ TullyModelThree
   │  └─ TullyModelTwo
   ├─ SpinBoson
   └─ ThreeStateMorse</code></pre><div class="admonition is-info"><header class="admonition-header">Contributing new models</header><div class="admonition-body"><p>To learn more about NQCModels.jl and learn how to implement new models, visit the <a href="../../devdocs/models/#devdocs-model">developer documentation</a>.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../saving_loading/">« Saving and loading</a><a class="docs-footer-nextpage" href="../analyticmodels/">Analytic model library »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Tuesday 14 June 2022 10:49">Tuesday 14 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
