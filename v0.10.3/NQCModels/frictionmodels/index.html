<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Electronic friction models · NQCDynamics.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/NQCModels/frictionmodels/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../ase/">ASE interface</a></li><li><a class="tocitem" href="../neuralnetworkmodels/">Neural network models</a></li><li class="is-active"><a class="tocitem" href>Electronic friction models</a><ul class="internal"><li><a class="tocitem" href="#Analytic-models"><span>Analytic models</span></a></li><li><a class="tocitem" href="#models-cubeldfa"><span>CubeLDFAModel.jl</span></a></li><li><a class="tocitem" href="#NNInterfaces.jl"><span>NNInterfaces.jl</span></a></li></ul></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/dynamicaldistribution/">Storing and sampling distributions</a></li><li><a class="tocitem" href="../../initialconditions/samplingmethods/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/samplingmethods/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/samplingmethods/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/samplingmethods/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-11-1" type="checkbox"/><label class="tocitem" for="menuitem-11-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticdistributions/">NonadiabaticDistributions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">NQCModels.jl</a></li><li class="is-active"><a href>Electronic friction models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Electronic friction models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/master/docs/src/NQCModels/frictionmodels.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="models-friction"><a class="docs-heading-anchor" href="#models-friction">Electronic friction models</a><a id="models-friction-1"></a><a class="docs-heading-anchor-permalink" href="#models-friction" title="Permalink"></a></h1><p>To perform <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">molecular dynamics with electronic friction (MDEF)</a> a specific type of model must be used that provides the friction tensor used to propagate the dynamics.</p><p>As detailed in the <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">MDEF page</a>, there are two ways to obtain friction values, either from the local density friction approximation (LDFA), or from time-dependent perturbation theory (TDPT). The models on this page describe our existing implementations.</p><h2 id="Analytic-models"><a class="docs-heading-anchor" href="#Analytic-models">Analytic models</a><a id="Analytic-models-1"></a><a class="docs-heading-anchor-permalink" href="#Analytic-models" title="Permalink"></a></h2><p>Since <em>ab initio</em> friction calculations are often expensive it is useful to have some models that we can use to test different friction methods. The <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DiabaticFrictionModel"><code>DiabaticFrictionModel</code></a> is the abstract type that groups together the diabatic models for which electronic friction can be evaluated. These have many electronic states, modelling the electronic structure characteristic of a metal.  The friction is calculated for these models directly from the nonadiabatic couplings with the equation:</p><p class="math-container">\[γ = 2\pi\hbar \sum_j &lt;1|dH|j&gt;&lt;j|dH|1&gt; \delta(\omega_j) / \omega_j\]</p><p>where the delta function is approximated by a normalised Gaussian function and the sum runs over the adiabatic states (<a href="../../references/#Box2021">Connor L. Box, Yaolong Zhang, Rongrong Yin, Bin Jiang, Reinhard J. Maurer (2021)</a>). The matrix elements in this equation are the position derivatives of the diabatic hamiltonian converted to the adiabatic representation.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The analytic friction models and the equation above are experimental and subject to change.</p></div></div><h2 id="models-cubeldfa"><a class="docs-heading-anchor" href="#models-cubeldfa">CubeLDFAModel.jl</a><a id="models-cubeldfa-1"></a><a class="docs-heading-anchor-permalink" href="#models-cubeldfa" title="Permalink"></a></h2><p>Our LDFA implementation is given in <a href="https://github.com/NQCD/CubeLDFAModel.jl">CubeLDFAModel.jl</a> which takes a <code>.cube</code> file containing the electron density and evaluates the friction based upon this local density.</p><p>The model works by fitting the LDA data provided by <a href="../../references/#Gerrits2020">Nick Gerrits, J. I\~naki Juaristi, J\&quot;org Meyer (2020)</a> that provides the LDFA friction coefficient as a function of the Wigner-Seitz radius. When the model is initialised, the LDA data from <a href="../../references/#Gerrits2020">Nick Gerrits, J. I\~naki Juaristi, J\&quot;org Meyer (2020)</a> is interpolated using <a href="https://github.com/PumasAI/DataInterpolations.jl">DataInterpolations.jl</a> with a cubic spline. Then, whenever required, the density at the current position is taken directly from the <code>.cube</code> file and converted to the Wigner-Seitz radius with the following relation:</p><p class="math-container">\[r_s(\rho) = (\frac{3}{4\pi \rho (\mathbf{r_{i}})})^{1/3}.\]</p><p>Then, the interpolation function is evaluated with this value for the radius, which gives the LDA friction. Optimally, this would be done via an <em>ab initio</em> calculation to get the electron density, but this model instead uses a pre-computed <code>.cube</code> file to get the density with minimal cost. This makes the assumption that the density does not change throughout the dynamics, or that the surface is assumed to be frozen in place.</p><p>This graph shows how we interpolate the LDA data and evaluate the friction coefficient as a function of the Wigner-Seitz radius. <img src="../../assets/figures/ldfa_graph.png" alt="ldfa graph"/></p><p>The <a href="../../examples/reactive_scattering/#example-h2scattering">reactive scattering example</a> uses this model to investigate the scattering of a diatomic molecule from a metal surface.</p><h2 id="NNInterfaces.jl"><a class="docs-heading-anchor" href="#NNInterfaces.jl">NNInterfaces.jl</a><a id="NNInterfaces.jl-1"></a><a class="docs-heading-anchor-permalink" href="#NNInterfaces.jl" title="Permalink"></a></h2><p>Another way to perform MDEF simulations is the use one of the models from <a href="https://github.com/NQCD/NNInterfaces.jl/"><code>NNInterfaces.jl</code></a> that uses a neural network to obtain the time-dependent perturbation theory friction from the atomic positions. As with LDFA, one of these models is used in the <a href="../../examples/reactive_scattering/#example-h2scattering">reactive scattering example</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../neuralnetworkmodels/">« Neural network models</a><a class="docs-footer-nextpage" href="../../initialconditions/dynamicaldistribution/">Storing and sampling distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Tuesday 22 March 2022 11:10">Tuesday 22 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
