<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NQCModels · NQCDynamics.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCModels/nonadiabaticmodels/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../../../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../../initialconditions/dynamicaldistribution/">Storing and sampling distributions</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-11-1" type="checkbox"/><label class="tocitem" for="menuitem-11-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox" checked/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../nninterfaces/">NNInterfaces</a></li><li class="is-active"><a class="tocitem" href>NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../NQCDynamics/nonadiabaticdistributions/">NonadiabaticDistributions</a></li><li><a class="tocitem" href="../../NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">NQCModels</a></li><li class="is-active"><a href>NQCModels</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>NQCModels</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/master/docs/src/api/NQCModels/nonadiabaticmodels.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="NQCModels"><a class="docs-heading-anchor" href="#NQCModels">NQCModels</a><a id="NQCModels-1"></a><a class="docs-heading-anchor-permalink" href="#NQCModels" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NQCModels.NQCModels" href="#NQCModels.NQCModels"><code>NQCModels.NQCModels</code></a> — <span class="docstring-category">Module</span></header><section><div><p>NQCModels define the potentials and derivatives that govern the dynamics of the particles. These can exist as analytic models or as interfaces to other codes. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.Model" href="#NQCModels.Model"><code>NQCModels.Model</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Top-level type for models.</p><p><strong>Implementation</strong></p><p>When adding new models, this should not be directly subtyped. Instead, depending on the intended functionality of the model, one of the child abstract types should be subtyped. If an appropriate type is not already available, a new abstract subtype should be created. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L15-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.derivative!-Tuple{NQCModels.Model, Any, AbstractMatrix}" href="#NQCModels.derivative!-Tuple{NQCModels.Model, Any, AbstractMatrix}"><code>NQCModels.derivative!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">derivative!(model::Model, D, R::AbstractMatrix)</code></pre><p>Fill <code>D</code> with the derivative of the electronic potential as a function of the positions <code>R</code>.</p><p>This must be implemented for all models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L69-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.derivative-Tuple{NQCModels.Model, Any}" href="#NQCModels.derivative-Tuple{NQCModels.Model, Any}"><code>NQCModels.derivative</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">derivative(model::Model, R)</code></pre><p>Allocating version of <code>derivative!</code>, this definition should be suitable for all models.</p><p>Implement <code>zero_derivative</code> to allocate an appropriate array then implement <code>derivative!</code> to fill the array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L93-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.ndofs" href="#NQCModels.ndofs"><code>NQCModels.ndofs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ndofs(::Model)</code></pre><p>Get the number of degrees of freedom for every atom in the model. Usually 1 or 3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L121-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.nstates" href="#NQCModels.nstates"><code>NQCModels.nstates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nstates(::Model)</code></pre><p>Get the number of electronic states in the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.potential!-Tuple{NQCModels.Model, Any, AbstractMatrix}" href="#NQCModels.potential!-Tuple{NQCModels.Model, Any, AbstractMatrix}"><code>NQCModels.potential!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">potential!(model::Model, V, R::AbstractMatrix)</code></pre><p>In-place version of <code>potential</code>, used only when mutable arrays are preferred.</p><p>Currently used only for <code>LargeDiabaticModels</code>, see <code>diabatic/DiabaticModels.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L47-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.potential-Tuple{NQCModels.Model, AbstractMatrix}" href="#NQCModels.potential-Tuple{NQCModels.Model, AbstractMatrix}"><code>NQCModels.potential</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">potential(model::Model, R::AbstractMatrix)</code></pre><p>Evaluate the potential at position <code>R</code> for the given <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCModels.zero_derivative" href="#NQCModels.zero_derivative"><code>NQCModels.zero_derivative</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">zero_derivative(model::Model, R)</code></pre><p>Create an zeroed array of the right size to match the derivative.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/2b52612fb7fa8f35a8d1f8441d5d3b1a4242e609/src/NQCModels.jl#L107-L111">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nninterfaces/">« NNInterfaces</a><a class="docs-footer-nextpage" href="../../NQCDynamics/calculators/">Calculators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Thursday 3 March 2022 13:55">Thursday 3 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
