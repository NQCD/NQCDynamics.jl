<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atoms · NQCDynamics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/atoms/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li class="is-active"><a class="tocitem" href>Atoms</a><ul class="internal"><li><a class="tocitem" href="#reading-and-writing"><span>Reading and writing atomic structures</span></a></li></ul></li><li><a class="tocitem" href="../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../initialconditions/dynamicaldistribution/">Storing and sampling distributions</a></li><li><a class="tocitem" href="../initialconditions/samplingmethods/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../initialconditions/samplingmethods/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../initialconditions/samplingmethods/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../initialconditions/samplingmethods/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-11-1" type="checkbox"/><label class="tocitem" for="menuitem-11-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../api/NQCDynamics/nonadiabaticdistributions/">NonadiabaticDistributions</a></li><li><a class="tocitem" href="../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Atoms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Atoms</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/master/docs/src/atoms.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="atoms"><a class="docs-heading-anchor" href="#atoms">Handling Atoms</a><a id="atoms-1"></a><a class="docs-heading-anchor-permalink" href="#atoms" title="Permalink"></a></h1><p>This package makes the choice to separate the atomic parameters from their positions and velocities for ease of use with the differential equations solvers. This contrasts somewhat with most other software packages where these would be usually by joined together into a single object.</p><p>The atomic parameters here are contained within the <a href="../api/NQCBase/nqcbase/#NQCBase.Atoms"><code>Atoms</code></a> type introduced earlier in the <a href="../getting_started/#Getting-started">Getting started</a> section. As mentioned previously, there exist some basic constructors which use either elemental symbols or numbers to initialise the parameters:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NQCDynamics</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms([:H, :H, :H])</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:H, :H, :H], [1, 1, 1], [1837.4715941070515, 1837.4715941070515, 1837.4715941070515])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms([1, 2, 3])</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:X, :X, :X], [0, 0, 0], [1.0, 2.0, 3.0])</code></pre><p>If there are many atoms, you can use Julia&#39;s array manipulation utilities to create large vectors with many atoms types. For example, if adding an adsorbate to a metal surface, it could be initialised as:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; au = fill(:Au, 40)</code><code class="nohighlight hljs ansi" style="display:block;">40-element Vector{Symbol}:
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 ⋮
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; no = [:N, :O]</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Symbol}:
 :N
 :O</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; auno = [au; no]</code><code class="nohighlight hljs ansi" style="display:block;">42-element Vector{Symbol}:
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 ⋮
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :N
 :O</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms(auno)</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au  …  :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :N, :O], [79, 79, 79, 79, 79, 79, 79, 79, 79, 79  …  79, 79, 79, 79, 79, 79, 79, 79, 7, 8], [359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214  …  359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 359048.09171127214, 25533.199026445902, 29164.39289099079])</code></pre><h2 id="reading-and-writing"><a class="docs-heading-anchor" href="#reading-and-writing">Reading and writing atomic structures</a><a id="reading-and-writing-1"></a><a class="docs-heading-anchor-permalink" href="#reading-and-writing" title="Permalink"></a></h2><p>When using a complex system however, it is likely more effective to read structures directly from a file. We provide two ways to do this, either using the  <a href="https://github.com/libAtoms/ExtXYZ.jl">ExtXYZ.jl</a> package which works for xyz files. Or instead there is a conversion to and from the <code>ase.Atoms</code> type which can be used when <a href="https://github.com/JuliaPy/PyCall.jl">PyCall.jl</a> is loaded.</p><p>First we can use <code>ase</code> to build a system and write it to an <code>.xyz</code> file.</p><pre><code class="language-julia hljs">using PyCall

build = pyimport(&quot;ase.build&quot;)

slab = build.fcc100(&quot;Al&quot;, size=(2, 2, 3))
build.add_adsorbate(slab, &quot;Au&quot;, 1.7, &quot;hollow&quot;)
slab.center(axis=2, vacuum=4.0)

slab.write(&quot;slab.xyz&quot;)</code></pre><p>Now we can read it in with the <a href="../api/NQCBase/nqcbase/#NQCBase.read_extxyz-Tuple{Any}"><code>read_extxyz</code></a> function.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms, positions, cell = read_extxyz(&quot;slab.xyz&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">(Atoms{Float64}([:Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Au], [13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 79], [49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 359048.09171127214]), [[0.0 5.411764529907055 … 5.411764529907055 2.7058822649535275; 0.0 0.0 … 5.411764529907055 2.7058822649535275; 7.558904498503081 7.558904498503081 … 15.21229530323745 18.42482971510126]], PeriodicCell{Float64}([10.823529074196882 0.0 0.0; 0.0 10.823529074196882 0.0; 0.0 0.0 25.98373421360434], [0.0923913072293568 0.0 0.0; 0.0 0.0923913072293568 0.0; 0.0 0.0 0.038485615338399996], Bool[1, 1, 0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], Bool[0, 0, 0]))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Al, :Au], [13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 79], [49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 49184.335999681345, 359048.09171127214])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; positions</code><code class="nohighlight hljs ansi" style="display:block;">1-element Vector{Matrix{Float64}}:
 [0.0 5.411764529907055 … 5.411764529907055 2.7058822649535275; 0.0 0.0 … 5.411764529907055 2.7058822649535275; 7.558904498503081 7.558904498503081 … 15.21229530323745 18.42482971510126]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cell</code><code class="nohighlight hljs ansi" style="display:block;">PeriodicCell{Float64}([10.823529074196882 0.0 0.0; 0.0 10.823529074196882 0.0; 0.0 0.0 25.98373421360434], [0.0923913072293568 0.0 0.0; 0.0 0.0923913072293568 0.0; 0.0 0.0 0.038485615338399996], Bool[1, 1, 0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], Bool[0, 0, 0])</code></pre><p>Similarly, we can write the file with <a href="../api/NQCBase/nqcbase/#NQCBase.write_extxyz-Tuple{Any, Any, Matrix, Any}"><code>write_extxyz</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; write_extxyz(&quot;out.xyz&quot;, atoms, positions, cell)</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Both of these functions also work with trajectories such that the positions will be a vector of configurations, whilst the atoms and cell will remain unchanged.</p><p>If not using <code>.xyz</code> files, we can directly use the IO capability of ase to read or the write the files. This can be done by using the conversions between our data types and the <code>ase.Atoms</code> object.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms = Atoms([:H, :H, :C])</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:H, :H, :C], [1, 1, 6], [1837.4715941070515, 1837.4715941070515, 21894.713607956142])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ase_atoms = NQCBase.convert_to_ase_atoms(atoms, rand(3, 3))</code><code class="nohighlight hljs ansi" style="display:block;">PyObject Atoms(symbols=&#39;H2C&#39;, pbc=False)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; NQCBase.convert_from_ase_atoms(ase_atoms)</code><code class="nohighlight hljs ansi" style="display:block;">(Atoms{Float64}([:H, :H, :C], [1, 1, 6], [1837.4715941070515, 1837.4715941070515, 21894.713607956142]), [0.4315473915811405 0.30852531557354257 0.15876088911861386; 0.641548732613398 0.06864578813848332 0.8231225829754228; 0.6343986860555668 0.9303736536998756 0.1670529092877866], InfiniteCell())</code></pre><p>These conversions work both ways such that you can read any file format using ase then convert the <code>ase.Atoms</code> object to our types afterwards. Then at the end when you are finished, you can convert them back and write your output with ase.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting started</a><a class="docs-footer-nextpage" href="../ensemble_simulations/">Ensemble simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Thursday 3 March 2022 13:55">Thursday 3 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
