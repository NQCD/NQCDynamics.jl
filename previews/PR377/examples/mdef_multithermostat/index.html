<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MDEF with the Two-temperature model and separate Electron and Phonon Thermostats · NQCDynamics.jl</title><meta name="title" content="MDEF with the Two-temperature model and separate Electron and Phonon Thermostats · NQCDynamics.jl"/><meta property="og:title" content="MDEF with the Two-temperature model and separate Electron and Phonon Thermostats · NQCDynamics.jl"/><meta property="twitter:title" content="MDEF with the Two-temperature model and separate Electron and Phonon Thermostats · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/examples/mdef_multithermostat/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/examples/mdef_multithermostat/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/examples/mdef_multithermostat/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/machinelearningmodels/">Machine learning interatomic potentials</a></li><li><a class="tocitem" href="../../NQCModels/fullsizemodels/">Full dimensional model library</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a><ul class="internal"><li><a class="tocitem" href="#Introtion"><span>Intro🦆tion</span></a></li><li><a class="tocitem" href="#The-two-temperature-model"><span>The two-temperature model</span></a></li><li><a class="tocitem" href="#Combining-MDEF-and-the-TTM"><span>Combining MDEF and the TTM</span></a></li></ul></li><li><a class="tocitem" href="../reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/FrictionProviders/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionProviders.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/mace/">MACEModels.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/examples/mdef_multithermostat.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mdef-ttm-example"><a class="docs-heading-anchor" href="#mdef-ttm-example">MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a><a id="mdef-ttm-example-1"></a><a class="docs-heading-anchor-permalink" href="#mdef-ttm-example" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This page focuses on using the model combination tools in NQCDynamics.jl and NQCModels.jl to perform MDEF simulations with separate thermostats for different parts of the system.  The page on <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">Molecular Dynamics with Electronic Friction</a> contains more information on MDEF as a method, and is a better starting point to setting up simulations. </p></div></div><h2 id="Introtion"><a class="docs-heading-anchor" href="#Introtion">Intro🦆tion</a><a id="Introtion-1"></a><a class="docs-heading-anchor-permalink" href="#Introtion" title="Permalink"></a></h2><p>On this page, we will look at the example of simulating the response of hydrogen adsorbed to a Cu(111) surface to an ultrafast laser pulse using <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">Molecular Dynamics with Electronic Friction</a> and the Two-temperature model.</p><p>As detailed before, the nuclear coordinates in MDEF evolve as follows:</p><p class="math-container">\[\mathbf{M}\ddot{\mathbf{R}} = - \nabla_R V(\mathbf{R}) + \mathbf{F}(t) - \Gamma(\mathbf{R}) \dot{\mathbf{R}}\]</p><p>The first term on the right hand side of the equation corresponds to a conservative force associated with the potential energy surface (PES) as in the adiabatic case. The third term is the friction force and it comes from multiplication between the electronic friction object (<span>$\Gamma(\mathbf{R})$</span>) and the velocity. Finally, the second term is a temperature and friction-dependent stochastic force which ensures detailed balance.</p><h2 id="The-two-temperature-model"><a class="docs-heading-anchor" href="#The-two-temperature-model">The two-temperature model</a><a id="The-two-temperature-model-1"></a><a class="docs-heading-anchor-permalink" href="#The-two-temperature-model" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Temperature profiles for the Two-temperature model can be generated using the <a href="https://github.com/maurergroup/LightMatter.jl">LightMatter.jl</a> package. (Will be released soon)</p></div></div><p>The two-temperature model (TTM) is a system of two coupled differential equations that describe the time evolution of the electronic and lattice temperatures, <span>$T_{el}$</span> and <span>$T_{ph}$</span>. In this work, lateral heat transport across the metal surface is neglected, allowing for a simplified one-dimensional representation of the two-temperature model. The TTM is given by the following set of equations: </p><p><strong>Electronic heat capacity</strong></p><p class="math-container">\[C_{el}\frac{\partial}{\partial t}T_{el}=\nabla(\kappa\nabla T_{el})-g(T_{el}-T_{ph})+S(z,t) \]</p><p><strong>Phononic heat capacity</strong></p><p class="math-container">\[C_{ph}\frac{\partial}{\partial t}T_{ph}=g(T_{el}-T_{ph}) \]</p><p><strong>Laser source term</strong></p><p class="math-container">\[S(z,t)=F\cdot\frac{\exp{\frac{-z}{\xi}}\cdot\exp{\frac{-(t-t_0)^2}{2r^2}}}{\xi\cdot\sqrt{2\pi}\tau}; 
		\tau=\frac{\mathrm{FWHM}}{2\sqrt{2\ln{2}}}\]</p><p>The model is parametrised with material-specific parameters obtained from ab-initio calculations or experiments. As an example, the material-specific parameters for bulk crystalline Cu are shown here ([<a href="../../references/#Scholz2019">21</a>]):</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Explanation</th><th style="text-align: right">Value</th></tr><tr><td style="text-align: right"><span>$g$</span></td><td style="text-align: right">Electron-phonon coupling constant</td><td style="text-align: right"><span>$1\times 10^{-17}~\mathrm{W~m^{-3}~K^{-1}}$</span></td></tr><tr><td style="text-align: right"><span>$\xi$</span></td><td style="text-align: right">Laser penetration depth for <span>$\lambda=400~\mathrm{nm}$</span></td><td style="text-align: right"><span>$\frac{1}{\xi}=14.9~\mathrm{nm}$</span></td></tr><tr><td style="text-align: right"><span>$\gamma_{el}$</span></td><td style="text-align: right">Scaling constant for the electronic heat capacity <span>$C_{el}$</span>.</td><td style="text-align: right"><span>$98.0~\mathrm{J~m^{-3}~K^{-2}}$</span></td></tr><tr><td style="text-align: right"><span>$\theta_D$</span></td><td style="text-align: right">Debye temperature of Cu.</td><td style="text-align: right"><span>$343~\mathrm{K}$</span></td></tr><tr><td style="text-align: right"><span>$N$</span></td><td style="text-align: right">Atom density of bulk Cu</td><td style="text-align: right"><span>$8.5\times 10^{28}$</span></td></tr><tr><td style="text-align: right"><span>$\kappa_{RT}$</span></td><td style="text-align: right">Thermal conductivity at room temperature</td><td style="text-align: right"><span>$401.0~\mathrm{W^{-1}~K^{-1}}$</span></td></tr><tr><td style="text-align: right"><span>$\mathrm{FWHM}$</span></td><td style="text-align: right">Full width half maximum of the laser pulse</td><td style="text-align: right"><span>$150~\mathrm{fs}$</span></td></tr></table><p>The electronic heat capacity <span>$C_{el}(T_{el})$</span> was determined using a linear scaling relation:</p><p class="math-container">\[C_{el}(T_{el})=\gamma_{el}T_{el} \]</p><p>The temperature dependence of the thermal conductivity of Cu was modelled using the following relation:</p><p class="math-container">\[\kappa(T_{el}, T_{ph})=\kappa_{RT}\frac{T_{el}}{T_{ph}}\]</p><p>The phononic heat capacity was calculated using the Debye model with <span>$N$</span> and <span>$\theta_D$</span> values given above:</p><p class="math-container">\[C_{ph}(T_{ph})=9nk_B\left(\frac{T_{ph}}{\theta_D}\right)^3\int_0^{\frac{\theta_D}{T_{ph}}}\frac{x^4e^x}{(e^x-1)^2}~dx\]</p><p>An example of the TTM progression for a <span>$80~\mathrm{J~m^{-2}}$</span> absorbed fluence is shown in the video below. </p><p><video src="../../assets/mdef-ttm-example/2TM_graphic.mp4" controls="true" title="Temperature progressions, energy distributions and laser power for a TTM progression."><a href="../../assets/mdef-ttm-example/2TM_graphic.mp4">Temperature progressions, energy distributions and laser power for a TTM progression.</a></video></p><p>In our implementation of the TTM, the temperature progressions are saved to CSV files, which need to be interpolated to provide a continuous temperature function to use for our <code>Simulation</code>s. </p><pre><code class="language-julia hljs">using BSplineKit
using Unitful, UnitfulAtomic
using CSV, DataFrames

&quot;&quot;&quot;
This function reads a CSV file for a TTM solution containing:
1. The time in ps
2. Electronic temperature
3. Phononic temperature

Depending on which index is specified, a continuous temperature function for the electronic or phononic temperature is returned. 
&quot;&quot;&quot;
function T_function_from_file(file::String, index::Int=2)
	TTM_file = CSV.read(file, DataFrame)
	T_spline = interpolate(TTM_file.Time, TTM_file[:, index], BSplineOrder(4)) # is a cubic spline
	T_extrapolation = extrapolate(T_spline, Smooth()) #! Don&#39;t use to go earlier than the first point!
	T_function(time_ps) = T_extrapolation(ustrip(u&quot;ps&quot;, time_ps)) * u&quot;K&quot;
	return T_function
end

T_el_function = T_function_from_file(&quot;ttm-file.csv&quot;, 2)
T_ph_function = T_function_from_file(&quot;ttm-file.csv&quot;, 3)</code></pre><h2 id="Combining-MDEF-and-the-TTM"><a class="docs-heading-anchor" href="#Combining-MDEF-and-the-TTM">Combining MDEF and the TTM</a><a id="Combining-MDEF-and-the-TTM-1"></a><a class="docs-heading-anchor-permalink" href="#Combining-MDEF-and-the-TTM" title="Permalink"></a></h2><p>The electron and phonon temperatures are propagated as described above, yielding temperature profiles that are applied to MDEF simulations through the <span>$\mathcal{W}$</span> term in the Langevin equation. <span>$T_{el}$</span> is applied directly to the adsorbate H atoms, while <span>$\gamma$</span> as a function of H positions is determined using one of the MLIPs detailed above.  <span>$T_{ph}$</span> is coupled to the surface Cu atoms using a position-independent coupling constant.</p><p><img src="../../assets/mdef-ttm-example/Thermostat_Strategies.svg" alt="Different thermostatting strategies for our system"/></p><p>As shown above, <span>$T_{ph}$</span> can enter our system in different ways. We will use <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.Subsystem"><code>Subsystem</code></a>s to generate a <a href="../../api/NQCModels/nonadiabaticmodels/#NQCModels.CompositeModel"><code>CompositeModel</code></a> and <a href="../../getting_started/#Simulation"><code>Simulation</code></a> for these different strategies. </p><pre><code class="language-julia hljs">using NQCDynamics
using Unitful, UnitfulAtomic
using MACEModels

# Import starting structure
atoms, position, cell = read_extxyz(&quot;starting_structure.xyz&quot;)

# Load PES model
pes_model = MACEModel(
	atoms,
	cell,
	[&quot;mace-model.model&quot;];
	device=&quot;cpu&quot;,
	default_dtype=Float32,
	mobile_atoms::Vector{Int}=18:56, # Keep the top 4 layers mobile, freeze the bottom 2. 
)

# Load adsorbate and surface friction models
adsorbate_friction_model = RandomFriction(3)
surface_friction_model = ConstantFriction(γ=0.2)</code></pre><p>Now that all models are defined, we can combine them in different ways for a simulation:</p><h3 id="Electron-thermostat-only"><a class="docs-heading-anchor" href="#Electron-thermostat-only">Electron thermostat only</a><a id="Electron-thermostat-only-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-thermostat-only" title="Permalink"></a></h3><pre><code class="language-julia hljs"># PES applies to all atoms
pes_subsystem = Subsystem(pes_model)

# Electronic friction applies to adsorbate atoms 55,56
electronic_friction = Subsystem(adsorbate_friction_model, indices=[55,56])

# Combine models and generate Simulation
combined_model = CompositeModel(pes_subsystem, electronic_friction)

sim_T_el_only = Simulation{MDEF}(
	atoms, 
	combined_model; 
	temperature = T_el_function, 
	cell=cell
)</code></pre><h3 id="Phonon-thermostatting-top-four-layers"><a class="docs-heading-anchor" href="#Phonon-thermostatting-top-four-layers">Phonon thermostatting top four layers</a><a id="Phonon-thermostatting-top-four-layers-1"></a><a class="docs-heading-anchor-permalink" href="#Phonon-thermostatting-top-four-layers" title="Permalink"></a></h3><pre><code class="language-julia hljs"># PES applies to all atoms
pes_subsystem = Subsystem(pes_model)

# Electronic friction applies to adsorbate atoms 55,56
electronic_friction = Subsystem(adsorbate_friction_model, indices=[55,56])

# Phononic friction applies to surface atoms 18:54
phononic_friction = Subsystem(surface_friction_model, indices=18:54)

# Combine models and generate Simulation
combined_model = CompositeModel(
	pes_subsystem, 
	electronic_friction, 
	phononic_friction
)

# Create TemperatureSetting objects to apply T_el to adsorbates, T_ph to surface
# Manually specified indices
electron_thermostat = TemperatureSetting(T_el_function, indices = [55,56]) 
# Inherit indices from a Subsystem
phonon_thermostat = TemperatureSetting(T_ph_function, phononic_friction) 

sim_T_el_only = Simulation{MDEF}(
	atoms, 
	combined_model; 
	temperature = [
		electron_thermostat,
		phonon_thermostat
	], 
	cell=cell
)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../output_and_analysis/intro/">« Simulations outputs and analysis functions</a><a class="docs-footer-nextpage" href="../reactive_scattering/">Reactive scattering from a metal surface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 8 March 2025 00:43">Saturday 8 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
