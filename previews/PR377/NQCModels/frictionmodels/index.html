<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Electronic friction models · NQCDynamics.jl</title><meta name="title" content="Electronic friction models · NQCDynamics.jl"/><meta property="og:title" content="Electronic friction models · NQCDynamics.jl"/><meta property="twitter:title" content="Electronic friction models · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/NQCModels/frictionmodels/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/NQCModels/frictionmodels/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/NQCModels/frictionmodels/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../machinelearningmodels/">Machine learning interatomic potentials</a></li><li><a class="tocitem" href="../fullsizemodels/">Full dimensional model library</a></li><li class="is-active"><a class="tocitem" href>Electronic friction models</a><ul class="internal"><li><a class="tocitem" href="#friction-providers"><span>FrictionProviders.jl</span></a></li><li><a class="tocitem" href="#Analytic-models"><span>Analytic models</span></a></li></ul></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/mdef_multithermostat/">MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a></li><li><a class="tocitem" href="../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/FrictionProviders/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionProviders.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/mace/">MACEModels.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">NQCModels.jl</a></li><li class="is-active"><a href>Electronic friction models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Electronic friction models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/NQCModels/frictionmodels.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="models-friction"><a class="docs-heading-anchor" href="#models-friction">Electronic friction models</a><a id="models-friction-1"></a><a class="docs-heading-anchor-permalink" href="#models-friction" title="Permalink"></a></h1><p>To perform <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">molecular dynamics with electronic friction (MDEF)</a> a specific type of model must be used that provides the friction tensor used to propagate the dynamics. For this we recommend using <a href="https://github.com/NQCD/FrictionProviders.jl">FrictionProviders.jl</a>, however, various analytic models can also be employed.</p><p>As detailed in the <a href="../../dynamicssimulations/dynamicsmethods/mdef/#mdef-dynamics">MDEF page</a>, there are two ways to obtain friction values, either from the local density friction approximation (LDFA), or from time-dependent perturbation theory (TDPT), also known as orbital-dependent friction (ODF). The models on this page describe our existing implementations.</p><h2 id="friction-providers"><a class="docs-heading-anchor" href="#friction-providers">FrictionProviders.jl</a><a id="friction-providers-1"></a><a class="docs-heading-anchor-permalink" href="#friction-providers" title="Permalink"></a></h2><p>Machine learning-based models, and cube-based calculators can called through <a href="https://github.com/NQCD/FrictionProviders.jl">FrictionProviders.jl</a> connector package.</p><p>Currently, <a href="https://github.com/NQCD/FrictionProviders.jl">FrictionProviders.jl</a> supports LDFA (density) models based on:</p><ul><li>Cube electronic densities</li><li>(ACEpotentials.jl)[https://github.com/ACEsuit/ACEpotentials.jl]</li><li>(Scikit-learn)[https://github.com/scikit-learn/scikit-learn]</li></ul><p>TDPT (ODF) friction models based on:</p><ul><li>(ACEds.jl)[https://github.com/ACEsuit/ACEds.jl]</li></ul><p>The use of <a href="https://github.com/NQCD/FrictionProviders.jl">FrictionProviders.jl</a> with LDFA (Cube calculator and ACE model), and TDPT (ACEds-based model) is explained on the <a href="../../examples/reactive_scattering/#example-h2scattering">reactive scattering example</a>, to investigate the scattering of a diatomic molecule from a metal surface.</p><h3 id="models-ldfa"><a class="docs-heading-anchor" href="#models-ldfa">Density models for LDFA</a><a id="models-ldfa-1"></a><a class="docs-heading-anchor-permalink" href="#models-ldfa" title="Permalink"></a></h3><p>Our Cube-LDFA implementation takes a <code>.cube</code> file containing the electron density, whereas the ML-LDFA models predict the density directly. In both cases the obtained local density is then used to evaluate the friction.</p><p>The model works by fitting the LDA data provided by [<a href="../../references/#Gerrits2020">2</a>] that provides the LDFA friction coefficient as a function of the Wigner-Seitz radius. When the model is initialised, the LDA data from [<a href="../../references/#Gerrits2020">2</a>] is interpolated using <a href="https://github.com/PumasAI/DataInterpolations.jl">DataInterpolations.jl</a> with a cubic spline. Then, whenever required, the density at the current position is taken directly from the <code>.cube</code> file and converted to the Wigner-Seitz radius with the following relation:</p><p class="math-container">\[r_s(\rho) = (\frac{3}{4\pi \rho (\mathbf{r_{i}})})^{1/3}.\]</p><p>Then, the interpolation function is evaluated with this value for the radius, which gives the LDA friction. Optimally, this would be done via an <em>ab initio</em> calculation to get the electron density, but this model instead uses a pre-computed <code>.cube</code> file to get the density with minimal cost. This makes the assumption that the density does not change throughout the dynamics, or that the surface is assumed to be frozen in place.</p><p>This graph shows how we interpolate the LDA data and evaluate the friction coefficient as a function of the Wigner-Seitz radius. <img src="../../assets/figures/ldfa_graph.png" alt="ldfa graph"/></p><h2 id="Analytic-models"><a class="docs-heading-anchor" href="#Analytic-models">Analytic models</a><a id="Analytic-models-1"></a><a class="docs-heading-anchor-permalink" href="#Analytic-models" title="Permalink"></a></h2><p>Since <em>ab initio</em> friction calculations are often expensive it is useful to have some models that we can use to test different friction methods. The <a href="../../api/NQCModels/diabaticmodels/#NQCModels.DiabaticModels.DiabaticFrictionModel"><code>DiabaticFrictionModel</code></a> is the abstract type that groups together the diabatic models for which electronic friction can be evaluated. These have many electronic states, modelling the electronic structure characteristic of a metal.  The friction is calculated for these models directly from the nonadiabatic couplings with the equation:</p><p class="math-container">\[γ = 2\pi\hbar \sum_j &lt;1|dH|j&gt;&lt;j|dH|1&gt; \delta(\omega_j) / \omega_j\]</p><p>where the delta function is approximated by a normalised Gaussian function and the sum runs over the adiabatic states ([<a href="../../references/#Box2021">3</a>]). The matrix elements in this equation are the position derivatives of the diabatic hamiltonian converted to the adiabatic representation.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The analytic friction models and the equation above are experimental and subject to change.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fullsizemodels/">« Full dimensional model library</a><a class="docs-footer-nextpage" href="../../NQCDistributions/overview/">NQCDistributions.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 8 March 2025 00:43">Saturday 8 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
