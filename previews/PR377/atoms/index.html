<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atoms · NQCDynamics.jl</title><meta name="title" content="Atoms · NQCDynamics.jl"/><meta property="og:title" content="Atoms · NQCDynamics.jl"/><meta property="twitter:title" content="Atoms · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/atoms/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/atoms/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/atoms/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li class="is-active"><a class="tocitem" href>Atoms</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#atoms-base"><span>Manipulating atomic structures with AtomsBase.jl</span></a></li><li><a class="tocitem" href="#Using-Python&#39;s-ase-package-from-Julia"><span>Using Python&#39;s <code>ase</code> package from Julia</span></a></li><li><a class="tocitem" href="#Saving-and-loading-with-AtomsIO.jl"><span>Saving and loading with AtomsIO.jl</span></a></li></ul></li><li><a class="tocitem" href="../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../NQCModels/machinelearningmodels/">Machine learning interatomic potentials</a></li><li><a class="tocitem" href="../NQCModels/fullsizemodels/">Full dimensional model library</a></li><li><a class="tocitem" href="../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../NQCDistributions/overview/">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/mdef_multithermostat/">MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a></li><li><a class="tocitem" href="../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCModels/FrictionProviders/">FrictionModels</a></li><li><a class="tocitem" href="../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/frictionmodels/">FrictionProviders.jl</a></li><li><a class="tocitem" href="../api/NQCModels/mace/">MACEModels.jl</a></li><li><a class="tocitem" href="../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../api/NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Atoms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Atoms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/atoms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="atoms"><a class="docs-heading-anchor" href="#atoms">Handling Atoms</a><a id="atoms-1"></a><a class="docs-heading-anchor-permalink" href="#atoms" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip: NQCDynamics.jl handles atoms differently to `ase`</header><div class="admonition-body"><p>This package makes the choice to separate the atomic parameters from their positions and velocities for ease of use with the differential equations solvers. This contrasts somewhat with most other software packages where these would be usually be joined together into a single object.</p></div></div><p>The atomic parameters here are contained within the <a href="../getting_started/#Atoms"><code>Atoms</code></a> type introduced earlier in the <a href="../getting_started/#Getting-started">Getting started</a> section. As mentioned previously, there exist some basic constructors which use either elemental symbols or numbers to initialise the parameters:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NQCDynamics</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms([:H, :H, :H])</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:H, :H, :H], [1, 1, 1], [1837.4715941070515, 1837.4715941070515, 1837.4715941070515])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms([1, 2, 3])</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:X, :X, :X], [0, 0, 0], [1.0, 2.0, 3.0])</code></pre><p>If there are many atoms, you can use Julia&#39;s array manipulation utilities to create large vectors with many atoms types. For example, if adding an adsorbate to a metal surface, it could be initialised as:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; au = fill(:Au, 40)</code><code class="nohighlight hljs ansi" style="display:block;">40-element Vector{Symbol}:
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 ⋮
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; no = [:N, :O]</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Symbol}:
 :N
 :O</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; auno = [au; no]</code><code class="nohighlight hljs ansi" style="display:block;">42-element Vector{Symbol}:
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 ⋮
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :Au
 :N
 :O</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Atoms(auno)</code><code class="nohighlight hljs ansi" style="display:block;">Atoms{Float64}([:Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au  …  :Au, :Au, :Au, :Au, :Au, :Au, :Au, :Au, :N, :O], [79, 79, 79, 79, 79, 79, 79, 79, 79, 79  …  79, 79, 79, 79, 79, 79, 79, 79, 7, 8], [359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164  …  359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 359048.0926227164, 25533.199026445902, 29164.39289099079])</code></pre><h1 id="atoms-base"><a class="docs-heading-anchor" href="#atoms-base">Manipulating atomic structures with AtomsBase.jl</a><a id="atoms-base-1"></a><a class="docs-heading-anchor-permalink" href="#atoms-base" title="Permalink"></a></h1><p><a href="https://github.com/JuliaMolSim/AtomsBase.jl">AtomsBase</a> provides a convenient format for representing atomic geometries, facilitating interoperability between a collection of different packages.</p><p>When working with NQCDynamics, the most useful packages are <a href="https://github.com/mfherbst/AtomsIO.jl">AtomsIO</a> for reading and writing structures and trajectories, and <a href="https://github.com/mfherbst/ASEconvert.jl">ASEconvert</a> for working with <a href="https://wiki.fysik.dtu.dk/ase/index.html">ASE</a> from within Julia.</p><h2 id="Using-Python&#39;s-ase-package-from-Julia"><a class="docs-heading-anchor" href="#Using-Python&#39;s-ase-package-from-Julia">Using Python&#39;s <code>ase</code> package from Julia</a><a id="Using-Python&#39;s-ase-package-from-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Python&#39;s-ase-package-from-Julia" title="Permalink"></a></h2><p>Julia provides multiple options to run Python-based code from Julia scripts. The NQCD packages provide compatibility with <a href="https://github.com/JuliaPy/PythonCall.jl"><strong>PythonCall.jl</strong></a>, and some deprecated interfaces for <a href="https://github.com/JuliaPy/PyCall.jl"><strong>PyCall.jl</strong></a> exist as well.  While both of these packages function similarly, PythonCall forces you as a user to think more about when data is copied in memory between Python and Julia, enabling more efficient code. </p><p>This example shows how <code>ase.build</code> can be used to build a structure from within Julia, then convert from the ASE format into the required objects for atoms, positions and unit cell for an NQCD simulation:</p><pre><code class="language-julia hljs">using PythonCall
using NQCBase

ase_build = pyimport(&quot;ase.build&quot;)

# Make a silicon supercell using ASE
atoms_ase = ase_build.bulk(&quot;Si&quot;) * pytuple((4, 1, 1))</code></pre><p>It is currently not possible to use an AtomsBase system directly with NQCDynamics, but can be quickly converted to the correct format:</p><pre><code class="language-julia hljs">using NQCDynamics

atoms_nqcd, positions_nqcd, cell_nqcd = convert_from_ase_atoms(atoms_ase)

println(atoms_nqcd)
println(positions_nqcd)
println(cell_nqcd)</code></pre><h2 id="Saving-and-loading-with-AtomsIO.jl"><a class="docs-heading-anchor" href="#Saving-and-loading-with-AtomsIO.jl">Saving and loading with AtomsIO.jl</a><a id="Saving-and-loading-with-AtomsIO.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-loading-with-AtomsIO.jl" title="Permalink"></a></h2><p>After running a simulation it often desirable to save the trajectory in a standard format for visualization. For this, convert the NQCDynamics output into the AtomsBase format, then use AtomsIO to write the file in your chosen format.</p><pre><code class="language-julia hljs">using AtomsIO

system = System(atoms_nqcd, r, v, c)

AtomsIO.save_system(&quot;Si.xyz&quot;, system) # Save a single image

trajectory = Trajectory(atoms_nqcd, [r, r, r, r], [v, v, v, v], c)
AtomsIO.save_trajectory(&quot;Si.xyz&quot;, trajectory) # Save a trajectory</code></pre><p>AtomsIO also provides <code>load_system</code> and <code>load_trajectory</code> which can be converted to the NQCDynamics format as above to initialise simulations. Refer to <a href="https://mfherbst.github.io/AtomsIO.jl/stable/">AtomsIO</a> for more information.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting started</a><a class="docs-footer-nextpage" href="../ensemble_simulations/">Ensemble simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 8 March 2025 00:43">Saturday 8 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
