<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>InitialConditions · NQCDynamics.jl</title><meta name="title" content="InitialConditions · NQCDynamics.jl"/><meta property="og:title" content="InitialConditions · NQCDynamics.jl"/><meta property="twitter:title" content="InitialConditions · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCDynamics/initialconditions.html"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCDynamics/initialconditions.html"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCDynamics/initialconditions.html"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../index.html"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../index.html">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../index.html">Introduction</a></li><li><a class="tocitem" href="../../getting_started.html">Getting started</a></li><li><a class="tocitem" href="../../atoms.html">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations.html">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading.html">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview.html">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels.html">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/fullsizemodels.html">Full dimensional model library</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels.html">Electronic friction models</a></li><li><a class="tocitem" href="../../NQCModels/neuralnetworkmodels.html">MLIP Examples</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview.html">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk.html">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian.html">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin.html">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings.html">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations.html">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical.html">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest.html">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh.html">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin.html">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef.html">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd.html">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd.html">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh.html">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro.html">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/reactive_scattering.html">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson.html">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse.html">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering.html">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms.html">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq.html">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models.html">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods.html">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCBase/nqcbase.html">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCModels/adiabaticmodels.html">AdiabaticModels</a></li><li><a class="tocitem" href="../NQCModels/cubeldfamodel.html">CubeLDFAModel</a></li><li><a class="tocitem" href="../NQCModels/diabaticmodels.html">DiabaticModels</a></li><li><a class="tocitem" href="../NQCModels/frictionmodels.html">FrictionModels</a></li><li><a class="tocitem" href="../NQCModels/mace.html">MACE interface</a></li><li><a class="tocitem" href="../NQCModels/nninterfaces.html">NNInterfaces</a></li><li><a class="tocitem" href="../NQCModels/nonadiabaticmodels.html">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCDistributions/nqcdistributions.html">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox" checked/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="analysis.html">Analysis</a></li><li><a class="tocitem" href="calculators.html">Calculators</a></li><li><a class="tocitem" href="dynamicsmethods.html">DynamicsMethods</a></li><li><a class="tocitem" href="dynamicsoutputs.html">DynamicsOutputs</a></li><li><a class="tocitem" href="dynamicsutils.html">DynamicsUtils</a></li><li><a class="tocitem" href="ensembles.html">Ensembles</a></li><li><a class="tocitem" href="estimators.html">Estimators</a></li><li class="is-active"><a class="tocitem" href="initialconditions.html">InitialConditions</a><ul class="internal"><li><a class="tocitem" href="#ThermalMonteCarlo"><span>ThermalMonteCarlo</span></a></li><li><a class="tocitem" href="#QuantisedDiatomic"><span>QuantisedDiatomic</span></a></li><li><a class="tocitem" href="#MetropolisHastings"><span>MetropolisHastings</span></a></li></ul></li><li><a class="tocitem" href="nonadiabaticmoleculardynamics.html">NQCDynamics</a></li><li><a class="tocitem" href="numericutils.html">Numerical utilities</a></li><li><a class="tocitem" href="ringpolymers.html">RingPolymers</a></li><li><a class="tocitem" href="structure.html">Structure</a></li><li><a class="tocitem" href="timecorrelationfunctions.html">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">NQCDynamics</a></li><li class="is-active"><a href="initialconditions.html">InitialConditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="initialconditions.html">InitialConditions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/api/NQCDynamics/initialconditions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="InitialConditions"><a class="docs-heading-anchor" href="#InitialConditions">InitialConditions</a><a id="InitialConditions-1"></a><a class="docs-heading-anchor-permalink" href="#InitialConditions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions" href="#NQCDynamics.InitialConditions"><code>NQCDynamics.InitialConditions</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">InitialConditions</code></pre><p>Functions and types for generating initial conditions for simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/InitialConditions.jl#L1-L5">source</a></section></article><h2 id="ThermalMonteCarlo"><a class="docs-heading-anchor" href="#ThermalMonteCarlo">ThermalMonteCarlo</a><a id="ThermalMonteCarlo-1"></a><a class="docs-heading-anchor-permalink" href="#ThermalMonteCarlo" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling-Tuple{Simulation, Any, Any}" href="#NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling-Tuple{Simulation, Any, Any}"><code>NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_advancedhmc_sampling(sim::Simulation, r, n_samples;
    target_acceptance=0.5, kwargs...)</code></pre><p>Perform Hamiltonian Monte Carlo sampling for the simulation <code>sim</code> using <code>AdvancedHMC.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/ThermalMonteCarlo.jl#L228-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling-Tuple{NQCDynamics.AbstractSimulation, Any, Real, Dict{Symbol, &lt;:Real}}" href="#NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling-Tuple{NQCDynamics.AbstractSimulation, Any, Real, Dict{Symbol, &lt;:Real}}"><code>NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_advancedmh_sampling(sim, r, steps, σ; movement_ratio=nothing, movement_ratio_internal=nothing, kwargs...)</code></pre><p>Sample the configuration space for the simulation <code>sim</code> starting from <code>r</code>.</p><p>Total number of steps is given by <code>steps</code> and <code>σ</code> is the dictionary of step sizes for each species.</p><p><code>movement_ratio</code> denotes the fraction of system moved each step. <code>internal_ratio</code> works as for <code>movement_ratio</code> but for the internal modes of the ring polymer. For <code>movement_ratio = 0</code>, every degree of freedom is moved at each step, if <code>movement_ratio = 1</code>, then nothing will happen. </p><p>If neither arguments are defined, default behaviour is to move one atom (and one ring polymer normal mode) per step on average. </p><p>Further kwargs are passed to <code>AdvancedMH.sample</code> to allow for <a href="https://turinglang.org/AbstractMCMC.jl/dev/api/#Common-keyword-arguments">extra functionality</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/ThermalMonteCarlo.jl#L29-L44">source</a></section></article><h2 id="QuantisedDiatomic"><a class="docs-heading-anchor" href="#QuantisedDiatomic">QuantisedDiatomic</a><a id="QuantisedDiatomic-1"></a><a class="docs-heading-anchor-permalink" href="#QuantisedDiatomic" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic" href="#NQCDynamics.InitialConditions.QuantisedDiatomic"><code>NQCDynamics.InitialConditions.QuantisedDiatomic</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">QuantisedDiatomic</code></pre><p>This module exports two user facing functions:</p><ul><li><p><code>generate_configurations</code>   Creates a set of velocities and positions for diatomic molecule with specified   vibrational <code>ν</code> and rotational <code>J</code> quantum numbers.</p></li><li><p><code>quantise_diatomic</code>   Obtains vibrational <code>ν</code> and rotational <code>J</code> quantum numbers for a diatomic molecule   with a given set of velocities and positions.</p></li></ul><p>The central concept of this module is the EBK procedure which is nicely detailed here: [<a href="../../references.html#Larkoski2006">4</a>]</p><p>Inspired by VENUS96: [<a href="../../references.html#Hase1996">28</a>]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!-Tuple{Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!-Tuple{Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Randomly rotate each column of two 3*N matrix, same rotation for all columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/random_configuration.jl#L65-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy-Tuple{Real, NQCModels.AdiabaticModels.AdiabaticModel, NQCDynamics.InitialConditions.QuantisedDiatomic.EvaluationEnvironment}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy-Tuple{Real, NQCModels.AdiabaticModels.AdiabaticModel, NQCDynamics.InitialConditions.QuantisedDiatomic.EvaluationEnvironment}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calculate_diatomic_energy(model::AdiabaticModel, bond_length::Real;
    height=10, normal_vector=[0, 0, 1])</code></pre><p>Returns potential energy of diatomic with <code>bond_length</code> at <code>height</code> from surface.</p><p>Orients molecule parallel to the surface at the specified height, the surface is assumed to intersect the origin. This requires that the model implicitly provides the surface, or works fine without one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/energy_evaluation.jl#L46-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.classical_rotation_energy-Tuple{Union{Int64, CartesianIndex}, Any, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.classical_rotation_energy-Tuple{Union{Int64, CartesianIndex}, Any, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.classical_rotation_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">classical_rotation_energy(J::Union{Int, CartesianIndex}, config::Any, ind1::Union{Int, CartesianIndex}, ind2::Union{Int, CartesianIndex}, sim::Simulation)</code></pre><p>Classical rotation energy of a rigid diatomic rotor in Hartree</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/rigid_rotator.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.classical_translational_energy-Tuple{Any, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.classical_translational_energy-Tuple{Any, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.classical_translational_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">classical_translational_energy(config::Any, ind1::Union{Int, CartesianIndex}, ind2::Union{Int, CartesianIndex}, sim::Simulation)</code></pre><p>Returns the classical translational energy in Hartree</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/rigid_rotator.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">combine_slab_and_molecule(atom_indices, molecule, slab)</code></pre><p>Revert the transformation <code>separate_slab_and_molecule</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/energy_evaluation.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic-Tuple{Any, Any, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.EvaluationEnvironment, NQCDynamics.InitialConditions.QuantisedDiatomic.GenerationParameters, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic-Tuple{Any, Any, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.EvaluationEnvironment, NQCDynamics.InitialConditions.QuantisedDiatomic.GenerationParameters, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Randomly orient molecule in space for a given bond length and radial momentum</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/random_configuration.jl#L39-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy-Tuple{NQCDynamics.InitialConditions.QuantisedDiatomic.EffectivePotential, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy-Tuple{NQCDynamics.InitialConditions.QuantisedDiatomic.EffectivePotential, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">find_total_energy(V::EffectivePotential, ν)</code></pre><p>Returns the energy associated with the specified quantum numbers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_configurations(sim, ν, J; samples=1000, height=10, normal_vector=[0, 0, 1],
    translational_energy=0, direction=[0, 0, -1], position=[0, 0, height])</code></pre><p>Generate positions and momenta for given quantum numbers</p><p><code>translational_energy</code>, <code>direction</code> and <code>position</code> specify the kinetic energy in a specific direction with the molecule placed with centre of mass at <code>position</code>.</p><p>Keyword arguments <code>height</code> and <code>normal_vector</code> become relevant if the potential requires specific placement of the molecule. These allow the molecule to be placed at a distance <code>height</code> in the direction <code>normal_vector</code> when performing potential evaluations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L73-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.harmonic_vibration_energy-Tuple{Union{Int64, CartesianIndex}, Float64, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.harmonic_vibration_energy-Tuple{Union{Int64, CartesianIndex}, Float64, Union{Int64, CartesianIndex}, Union{Int64, CartesianIndex}, Simulation}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.harmonic_vibration_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">harmonic_vibration_energy(ν::Union{Int, CartesianIndex}, k::Float, ind1::Union{Int, CartesianIndex}=1, ind2::Union{Int, CartesianIndex}=2, sim::Simulation)</code></pre><p>Vibrational energy of a harmonic oscillator with the force constant k and vibrational level ν. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/rigid_rotator.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix, NQCDynamics.InitialConditions.QuantisedDiatomic.BindingCurve}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix, NQCDynamics.InitialConditions.QuantisedDiatomic.BindingCurve}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">quantise_diatomic(sim::Simulation, v::Matrix, r::Matrix, binding_curve::BindingCurve;
show_timer=false, reset_timer=false,
height=10, normal_vector=[0, 0, 1], atom_indices=[1,2], max_translation=1) 
)</code></pre><p>Quantise the vibrational and rotational degrees of freedom for the specified positions and velocities using the <code>BindingCurve</code> specified.  A binding curve will be automatically generated if you do not supply one. </p><p>If the potential can be evaluated for the diatomic only, independent of position,  supplying a <code>Simulation</code> for just the diatomic will speed up evaluation. </p><p>When evaluating the potential, the molecule is moved to <code>height</code> in direction <code>normal_vector</code>. If the potential is independent of centre of mass position, this has no effect. Otherwise, be sure to modify these parameters to give the intended behaviour.</p><p>If a <code>Simulation</code> with a <code>PeriodicCell</code> is supplied, periodic copies of the diatomic atoms  will be used if positions are close to cell boundaries.  Set <code>max_translation</code> to the radius of surrounding unit cells to search.  (e.g. 1 if positions are already wrapped around cell boundaries)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L363-L384">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">quantise_diatomic(sim::Simulation, v::Matrix, r::Matrix; 
bond_lengths=0.5:0.01:5.0, 
height=10.0, 
surface_normal=[0, 0, 1.0], 
atom_indices=[1, 2], 
max_translation=1,
show_timer=false, reset_timer=false
)</code></pre><p>Quantise the vibrational and rotational degrees of freedom for the specified positions and velocities.</p><p>If the potential can be evaluated for the diatomic only, independent of position,  supplying a <code>Simulation</code> for just the diatomic will speed up evaluation. </p><p>When evaluating the potential, the molecule is moved to <code>height</code> in direction <code>normal_vector</code>. If the potential is independent of centre of mass position, this has no effect. Otherwise, be sure to modify these parameters to give the intended behaviour.</p><p>If a <code>Simulation</code> with a <code>PeriodicCell</code> is supplied, periodic copies of the diatomic atoms  will be used if positions are close to cell boundaries.  Set <code>max_translation</code> to the radius of surrounding unit cells to search.  (e.g. 1 if positions are already wrapped around cell boundaries)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L274-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Vector{&lt;:Matrix}, Vector{&lt;:Matrix}}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Vector{&lt;:Matrix}, Vector{&lt;:Matrix}}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">quantise_diatomic(sim::Simulation, v::Vector{Matrix}, r::Vector{Matrix};
bond_lengths=0.5:0.01:5.0, 
height=10.0, 
surface_normal=[0, 0, 1.0], 
atom_indices=[1, 2], 
show_timer=false, reset_timer=false
)</code></pre><p>Quantise the vibrational and rotational degrees of freedom of multiple atomic configurations  given as a vector of velocity matrices and a vector of position matrices. </p><p>If the potential can be evaluated for the diatomic only, independent of position,  supplying a <code>Simulation</code> for just the diatomic will speed up evaluation. </p><p>When evaluating the potential, the molecule is moved to <code>height</code> in direction <code>normal_vector</code>. If the potential is independent of centre of mass position, this has no effect. Otherwise, be sure to modify these parameters to give the intended behaviour.</p><p>If a <code>Simulation</code> with a <code>PeriodicCell</code> is supplied, periodic copies of the diatomic atoms  will be used if positions are close to cell boundaries.  Set <code>max_translation</code> to the radius of surrounding unit cells to search.  (e.g. 1 if positions are already wrapped around cell boundaries)</p><p>Specify <code>show_timer=true</code> for performance timings of the EBK quantisation process and <code>reset_timer=true</code> to see timings for each individual quantisation. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L310-L336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Pick a random bond length and corresponding radial momentum that matches the radial probability distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/random_configuration.jl#L11-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule-Tuple{Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule-Tuple{Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">separate_slab_and_molecule(atom_indices, r)</code></pre><p>Get the coordinates of the molecule and slab separately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/energy_evaluation.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.sqrt_avoid_negatives-Tuple{Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.sqrt_avoid_negatives-Tuple{Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.sqrt_avoid_negatives</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sqrt_avoid_negatives(x)</code></pre><p>Same as <code>sqrt</code> but returns <code>zero(x)</code> if <code>x</code> is negative. Used here just in case the endpoints are a little off.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/QuantisedDiatomic/QuantisedDiatomic.jl#L142-L147">source</a></section></article><h2 id="MetropolisHastings"><a class="docs-heading-anchor" href="#MetropolisHastings">MetropolisHastings</a><a id="MetropolisHastings-1"></a><a class="docs-heading-anchor-permalink" href="#MetropolisHastings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings" href="#NQCDynamics.InitialConditions.MetropolisHastings"><code>NQCDynamics.InitialConditions.MetropolisHastings</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">MetropolisHastings</code></pre><p>Sampling of the initial conditions using the Metropolis-Hastings Markov chain Monte Carlo method.</p><p>Included within is the ability to sample the canonical distribution for adiabatic classical and ring polymer systems.</p><p>Usage involves creating an instance of an <code>AbstractSystem{MonteCarlo}</code> and calling <code>run_monte_carlo_sampling</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo" href="#NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo"><code>NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameters for Monte carlo simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L35-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput" href="#NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput"><code>NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Container for storing simulation quantities</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L84-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo}" href="#NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo}"><code>NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">acceptance_probability(system::AbstractSystem{MonteCarlo})</code></pre><p>Return the Metropolis-Hastings acceptance probability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L270-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!-Tuple{Atoms, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, AbstractMatrix, Integer, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!-Tuple{Atoms, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, AbstractMatrix, Integer, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">apply_random_perturbation!(system::AbstractSystem{MonteCarlo}, R::AbstractMatrix, atom::Integer)</code></pre><p>Randomly perturb the xyz coordinates of a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L223-L227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!-Tuple{NQCDynamics.AbstractSimulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, Any, Any, Any, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!-Tuple{NQCDynamics.AbstractSimulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, Any, Any, Any, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assess_proposal!(system::AbstractSystem{MonteCarlo}, Rᵢ, Rₚ, output, i)</code></pre><p>Update the energy, check for acceptance, and update the output. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L252-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T&lt;:AbstractFloat" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T&lt;:AbstractFloat"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_centroid_move!(system::RingPolymerSystem{MonteCarlo}, Rᵢ::Array{T, 3}, Rₚ::Array{T, 3}) where {T&lt;:AbstractFloat}</code></pre><p>Propose a move for the ring polymer centroid for one atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L206-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_move!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_move!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_move!(system::System{MonteCarlo}, Rᵢ::Matrix{T}, Rₚ::Matrix{T}) where {T&lt;:AbstractFloat}</code></pre><p>Propose simple cartesian move for a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L196-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_normal_mode_move!(system::RingPolymerSystem{MonteCarlo}, Rᵢ::Array{T, 3}, Rₚ::Array{T, 3}) where {T}</code></pre><p>Propose a move for a single normal mode for a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L232-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_main_loop!(system::System{MonteCarlo}, Rᵢ::Matrix, Rₚ::Matrix, output::MonteCarloOutput)</code></pre><p>Main loop for classical systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Main loop for ring polymer systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L165-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling-Union{Tuple{T}, Tuple{Simulation, Matrix{T}, Dict{Symbol, T}, Real}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling-Union{Tuple{T}, Tuple{Simulation, Matrix{T}, Dict{Symbol, T}, Real}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_monte_carlo_sampling(sim::AbstractSimulation, monte::MonteCarloParameters, R0)</code></pre><p>Perform Monte Carlo sampling for the system defined by the <code>sim</code> and <code>monte</code> parameters.</p><p>From the initial positions specified <code>R0</code> the system will be explored using the Metropolis-Hastings algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L104-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.write_output!-Tuple{NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput, AbstractArray, AbstractFloat}" href="#NQCDynamics.InitialConditions.MetropolisHastings.write_output!-Tuple{NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput, AbstractArray, AbstractFloat}"><code>NQCDynamics.InitialConditions.MetropolisHastings.write_output!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_output!(output::MonteCarloOutput, Rᵢ::AbstractArray, energy::AbstractFloat, i::Integer)</code></pre><p>Store the current configuration and associated energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/v0.13.7/src/InitialConditions/MetropolisHastings.jl#L283-L287">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="estimators.html">« Estimators</a><a class="docs-footer-nextpage" href="nonadiabaticmoleculardynamics.html">NQCDynamics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 16 July 2024 10:48">Tuesday 16 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
