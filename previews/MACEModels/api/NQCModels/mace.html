<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MACE interface · NQCDynamics.jl</title><meta name="title" content="MACE interface · NQCDynamics.jl"/><meta property="og:title" content="MACE interface · NQCDynamics.jl"/><meta property="twitter:title" content="MACE interface · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCModels/mace.html"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCModels/mace.html"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCModels/mace.html"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../index.html"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../index.html">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../index.html">Introduction</a></li><li><a class="tocitem" href="../../getting_started.html">Getting started</a></li><li><a class="tocitem" href="../../atoms.html">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations.html">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading.html">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview.html">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels.html">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/fullsizemodels.html">Full dimensional model library</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels.html">Electronic friction models</a></li><li><a class="tocitem" href="../../NQCModels/neuralnetworkmodels.html">MLIP Examples</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../../NQCDistributions/overview.html">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk.html">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian.html">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin.html">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings.html">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations.html">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical.html">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest.html">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh.html">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin.html">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef.html">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd.html">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd.html">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh.html">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro.html">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/reactive_scattering.html">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson.html">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse.html">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering.html">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms.html">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq.html">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models.html">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods.html">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCBase/nqcbase.html">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox" checked/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="adiabaticmodels.html">AdiabaticModels</a></li><li><a class="tocitem" href="cubeldfamodel.html">CubeLDFAModel</a></li><li><a class="tocitem" href="diabaticmodels.html">DiabaticModels</a></li><li><a class="tocitem" href="frictionmodels.html">FrictionModels</a></li><li class="is-active"><a class="tocitem" href="mace.html">MACE interface</a><ul class="internal"><li><a class="tocitem" href="#Possible-output-data"><span>Possible output data</span></a></li></ul></li><li><a class="tocitem" href="nninterfaces.html">NNInterfaces</a></li><li><a class="tocitem" href="nonadiabaticmodels.html">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCDistributions/nqcdistributions.html">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../NQCDynamics/analysis.html">Analysis</a></li><li><a class="tocitem" href="../NQCDynamics/calculators.html">Calculators</a></li><li><a class="tocitem" href="../NQCDynamics/dynamicsmethods.html">DynamicsMethods</a></li><li><a class="tocitem" href="../NQCDynamics/dynamicsoutputs.html">DynamicsOutputs</a></li><li><a class="tocitem" href="../NQCDynamics/dynamicsutils.html">DynamicsUtils</a></li><li><a class="tocitem" href="../NQCDynamics/ensembles.html">Ensembles</a></li><li><a class="tocitem" href="../NQCDynamics/estimators.html">Estimators</a></li><li><a class="tocitem" href="../NQCDynamics/initialconditions.html">InitialConditions</a></li><li><a class="tocitem" href="../NQCDynamics/nonadiabaticmoleculardynamics.html">NQCDynamics</a></li><li><a class="tocitem" href="../NQCDynamics/numericutils.html">Numerical utilities</a></li><li><a class="tocitem" href="../NQCDynamics/ringpolymers.html">RingPolymers</a></li><li><a class="tocitem" href="../NQCDynamics/structure.html">Structure</a></li><li><a class="tocitem" href="../NQCDynamics/timecorrelationfunctions.html">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">NQCModels</a></li><li class="is-active"><a href="mace.html">MACE interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="mace.html">MACE interface</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/api/NQCModels/mace.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MACE-interface"><a class="docs-heading-anchor" href="#MACE-interface">MACE interface</a><a id="MACE-interface-1"></a><a class="docs-heading-anchor-permalink" href="#MACE-interface" title="Permalink"></a></h1><h2 id="Possible-output-data"><a class="docs-heading-anchor" href="#Possible-output-data">Possible output data</a><a id="Possible-output-data-1"></a><a class="docs-heading-anchor-permalink" href="#Possible-output-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.MACEModel" href="#NQCModels.AdiabaticModels.MACE.MACEModel"><code>NQCModels.AdiabaticModels.MACE.MACEModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>MACE interface with support for ensemble of models and batch size selection for potentially faster inference.</p><p>DOFs currently hardcoded at 3.</p><p><strong>Fields</strong></p><ul><li><code>model_paths::Vector{String}</code>: Model paths to load. If multiple paths are given, an ensemble of models is used and mean energies/forces used to propagate dynamics.</li><li><code>models::Vector</code>: Loaded models.</li><li><code>device::Vector{String}</code>: Device to use for inference. If a single device is given, all models will be loaded on that device. If multiple devices are given, each model will be loaded on the corresponding device. Default is <code>&quot;cpu&quot;</code>.</li><li><code>default_dtype::Type{T}</code>: Default data type for inference. Default is <code>Float32</code>.</li><li><code>batch_size::Union{Int,Nothing}</code>: Batch size for inference. Default is <code>1</code>.</li><li><code>cutoff_radius::T</code>: Cutoff radius for the models.</li><li><code>last_eval_cache::MACEPredictionCache</code>: Cache for the last evaluation.</li><li><code>z_table</code>: Table of atomic numbers.</li><li><code>atoms::Atoms</code>: Atoms object for the system.</li><li><code>cell::PeriodicCell</code>: Periodic cell for the system.</li><li><code>ndofs::Int</code>: Number of degrees of freedom in the system.</li><li><code>mobile_atoms::Vector{Int}</code>: Indices of mobile atoms in the system.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L50-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.MACEModel-Tuple{Atoms, AbstractCell, Vector{String}}" href="#NQCModels.AdiabaticModels.MACE.MACEModel-Tuple{Atoms, AbstractCell, Vector{String}}"><code>NQCModels.AdiabaticModels.MACE.MACEModel</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MACEModel(
atoms::Atoms,
cell::AbstractCell,
model_paths::Vector{String};
device::Union{String,Vector{String}}=&quot;cpu&quot;,
default_dtype::Type=Float32,
batch_size::Int=1,
mobile_atoms::Vector{Int}=collect(1:length(atoms)),</code></pre><p>)     model<em>paths::Vector{String},     device::Union{String, Vector{String}}=&quot;cpu&quot;,     default</em>dtype::Type=Float64,     batch_size::Int=1,     atoms,     cell, )</p><p>Interface to MACE machine learning interatomic potentials with support for ensemble of models and batch size selection for potentially faster inference.</p><p><strong>Arguments</strong></p><ul><li><code>atoms</code>: Atoms object for the system. <code>predict!</code> can be called with a Vector of different Atoms objects to evaluate different structures.</li><li><code>cell</code>: Cell object for the system. <code>predict!</code> can be called with a Vector of different Cell objects to evaluate different structures.</li><li><code>model_paths::Vector{String}</code>: Model paths to load. If multiple paths are given, an ensemble of models is used and mean energies/forces used to propagate dynamics.</li><li><code>device::Union{String, Vector{String}}</code>: Device to use for inference. If a single device is given, all models will be loaded on that device. If multiple devices are given, each model will be loaded on the corresponding device. Default is <code>&quot;cpu&quot;</code>.</li><li><code>default_dtype::Type</code>: Default data type for PyTorch (usually Float32)</li><li><code>batch_size::Int</code>: Batch size for inference. Can be set to <code>nothing</code> to always adapt batch size to the number of structures provided. Ring-polymer methods benefit from this.</li><li><code>mobile_atoms::Vector{Int}</code>: Indices of mobile atoms in the system. Default is all atoms.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L90-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.MACEPredictionCache" href="#NQCModels.AdiabaticModels.MACE.MACEPredictionCache"><code>NQCModels.AdiabaticModels.MACE.MACEPredictionCache</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Cache which stores the results of the last evaluation of the MACE model. This is used to speed up concurrent energy and force evaluations, as well as to give access to ensemble predictions.</p><p>Use e.g. <code>get_energy_mean(MACEModel.last_eval_cache)</code> to access results of the last prediction made by the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_energy_ensemble-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_energy_ensemble-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_energy_ensemble</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_energy_ensemble(mace_cache::MACEPredictionCache)</code></pre><p>Returns the potential energy evaluated by each model in the ensemble in units of <strong>Hartree</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L408-L412">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_energy_mean-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_energy_mean-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_energy_mean</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_energy_mean(mace_cache::MACEPredictionCache)</code></pre><p>Returns the mean potential energy of the structures stored in the evaluation cache.</p><p>Energy is returned in units of <strong>Hartree</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L372-L378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_energy_variance-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_energy_variance-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_energy_variance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_energy_variance(mace_cache::MACEPredictionCache)</code></pre><p>Returns the variance of the potential energy in <strong>Hartree²</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L391-L395">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_forces_ensemble-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_forces_ensemble-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_forces_ensemble</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_forces_ensemble(mace_cache::MACEPredictionCache)</code></pre><p>Returns the forces evaluated by each model in the ensemble in units of <strong>Hartree/Bohr</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L461-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_forces_mean-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_forces_mean-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_forces_mean</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_forces_mean(mace_cache::MACEPredictionCache)</code></pre><p>Returns the mean forces of the structures stored in the evaluation cache. Forces are returned in units of <strong>Hartree/Bohr</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L425-L430">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.get_forces_variance-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}" href="#NQCModels.AdiabaticModels.MACE.get_forces_variance-Tuple{NQCModels.AdiabaticModels.MACE.MACEPredictionCache}"><code>NQCModels.AdiabaticModels.MACE.get_forces_variance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_forces_variance(mace_cache::MACEPredictionCache)</code></pre><p>Returns the force variance of the structures stored in the evaluation cache. Forces are returned in units of <strong>Hartree²/Bohr²</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L443-L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.mace_configuration_from_nqcd_configuration-Tuple{Atoms, Union{InfiniteCell, PeriodicCell}, AbstractMatrix}" href="#NQCModels.AdiabaticModels.MACE.mace_configuration_from_nqcd_configuration-Tuple{Atoms, Union{InfiniteCell, PeriodicCell}, AbstractMatrix}"><code>NQCModels.AdiabaticModels.MACE.mace_configuration_from_nqcd_configuration</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mace_configuration_from_nqcd_configuration(
atoms::Atoms,
cell::Union{InfiniteCell, PeriodicCell},
R::AbstractMatrix,</code></pre><p>)</p><p>Converter into a single mace.data.utils.Configuration to make use of MACE&#39;s data loading.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L209-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.predict!-Tuple{MACEModel, Union{Atoms, Vector{&lt;:Atoms}}, Vector{&lt;:AbstractMatrix}, Union{AbstractCell, Vector{&lt;:AbstractCell}}}" href="#NQCModels.AdiabaticModels.MACE.predict!-Tuple{MACEModel, Union{Atoms, Vector{&lt;:Atoms}}, Vector{&lt;:AbstractMatrix}, Union{AbstractCell, Vector{&lt;:AbstractCell}}}"><code>NQCModels.AdiabaticModels.MACE.predict!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict!(
mace_interface::MACEModel,
atoms::Union{Vector{&lt;:Atoms}, Atoms},
R::Vector{&lt;:AbstractMatrix},
cell::Union{Vector{&lt;:AbstractCell}, AbstractCell},
)</code></pre><p>Evaluate the MACE model on a set of structures if they haven&#39;t already been evaluated. The results are stored in <code>mace_interface.last_eval_cache</code>.</p><p>Use <code>methodswith(MACEPredictionCache)</code> to see what data is provided from the results</p><p><strong>Arguments</strong></p><p><code>mace_interface</code>: <code>MACEModel</code> to evaluate with.</p><p><code>atoms</code>: Atoms object for the structures passed for evaluation. Can be either a vector of different Atoms objects or a single Atoms object.</p><p><code>R</code>: Vector of structures to evaluate.</p><p><code>cell</code>: Cell object for the structures passed for evaluation. Can be either a vector of different Cell objects or a single Cell object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L260-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.AdiabaticModels.MACE.predict-Tuple{MACEModel, Union{Atoms, Vector{&lt;:Atoms}}, Vector{&lt;:AbstractMatrix}, Union{AbstractCell, Vector{&lt;:AbstractCell}}}" href="#NQCModels.AdiabaticModels.MACE.predict-Tuple{MACEModel, Union{Atoms, Vector{&lt;:Atoms}}, Vector{&lt;:AbstractMatrix}, Union{AbstractCell, Vector{&lt;:AbstractCell}}}"><code>NQCModels.AdiabaticModels.MACE.predict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(
mace_interface::MACEModel,
atoms::Union{Vector{&lt;:Atoms}, Atoms},
R::Vector{&lt;:AbstractMatrix},
cell::Union{Vector{&lt;:AbstractCell}, AbstractCell},
)</code></pre><p>Evaluate the MACE model on a set of structures if they haven&#39;t already been evaluated. The results are returned as a <code>MACEPredictionCache</code>.</p><p>Use <code>methodswith(MACEPredictionCache)</code> to see what data can be provided from the results.</p><p><strong>Arguments</strong></p><p><code>mace_interface</code>: <code>MACEModel</code> to evaluate with.</p><p><code>atoms</code>: Atoms object for the structures passed for evaluation. Can be either a vector of different Atoms objects or a single Atoms object.</p><p><code>R</code>: Vector of structures to evaluate.</p><p><code>cell</code>: Cell object for the structures passed for evaluation. Can be either a vector of different Cell objects or a single Cell object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L336-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.derivative!-Union{Tuple{T}, Tuple{MACEModel, Atoms, AbstractArray{T, 3}, Vector{&lt;:AbstractMatrix}, Union{InfiniteCell, PeriodicCell}}} where T" href="#NQCModels.derivative!-Union{Tuple{T}, Tuple{MACEModel, Atoms, AbstractArray{T, 3}, Vector{&lt;:AbstractMatrix}, Union{InfiniteCell, PeriodicCell}}} where T"><code>NQCModels.derivative!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NQCModels.derivative(model::MACEModel, atoms::Atoms, R::AbstractArray{T,3}, cell::Union{InfiniteCell, PeriodicCell})</code></pre><p>This variant of <code>NQCModels.derivative</code> can make use of batch evaluation to speed up inference for multiple structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L542-L547">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.derivative-Tuple{MACEModel, Atoms, Vector{&lt;:AbstractMatrix}, Union{InfiniteCell, PeriodicCell}}" href="#NQCModels.derivative-Tuple{MACEModel, Atoms, Vector{&lt;:AbstractMatrix}, Union{InfiniteCell, PeriodicCell}}"><code>NQCModels.derivative</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NQCModels.derivative(model::MACEModel, atoms::Atoms, R::Vector{&lt;:AbstractMatrix}, cell::Union{InfiniteCell, PeriodicCell})</code></pre><p>This variant of <code>NQCModels.derivative</code> can make use of batch evaluation to speed up inference for multiple structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L524-L529">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NQCModels.potential-Tuple{MACEModel, Atoms, Vector{&lt;:AbstractMatrix}, AbstractCell}" href="#NQCModels.potential-Tuple{MACEModel, Atoms, Vector{&lt;:AbstractMatrix}, AbstractCell}"><code>NQCModels.potential</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NQCModels.potential(model::MACEModel, atoms::Atoms, R::Vector{&lt;:AbstractMatrix}, cell::AbstractCell)</code></pre><p>This variant of <code>NQCModels.potential</code> can make use of batch evaluation to speed up inference for multiple structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCModels.jl/blob/v0.8.99/src/adiabatic/mace.jl#L511-L516">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="frictionmodels.html">« FrictionModels</a><a class="docs-footer-nextpage" href="nninterfaces.html">NNInterfaces »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 16 July 2024 10:48">Tuesday 16 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
