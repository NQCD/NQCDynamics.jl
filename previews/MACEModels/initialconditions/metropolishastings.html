<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermal Metropolis-Hastings Monte Carlo · NQCDynamics.jl</title><meta name="title" content="Thermal Metropolis-Hastings Monte Carlo · NQCDynamics.jl"/><meta property="og:title" content="Thermal Metropolis-Hastings Monte Carlo · NQCDynamics.jl"/><meta property="twitter:title" content="Thermal Metropolis-Hastings Monte Carlo · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/metropolishastings.html"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/metropolishastings.html"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/metropolishastings.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><a class="tocitem" href="../getting_started.html">Getting started</a></li><li><a class="tocitem" href="../atoms.html">Atoms</a></li><li><a class="tocitem" href="../ensemble_simulations.html">Ensemble simulations</a></li><li><a class="tocitem" href="../saving_loading.html">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../NQCModels/overview.html">NQCModels.jl</a></li><li><a class="tocitem" href="../NQCModels/analyticmodels.html">Analytic model library</a></li><li><a class="tocitem" href="../NQCModels/fullsizemodels.html">Full dimensional model library</a></li><li><a class="tocitem" href="../NQCModels/frictionmodels.html">Electronic friction models</a></li><li><a class="tocitem" href="../NQCModels/neuralnetworkmodels.html">MLIP Examples</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li><a class="tocitem" href="../NQCDistributions/overview.html">NQCDistributions.jl</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="ebk.html">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="hamiltonian.html">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="langevin.html">Thermal Langevin dynamics</a></li><li class="is-active"><a class="tocitem" href="metropolishastings.html">Thermal Metropolis-Hastings Monte Carlo</a><ul class="internal"><li><a class="tocitem" href="#Example-1"><span>Example 1</span></a></li><li><a class="tocitem" href="#Example-2"><span>Example 2</span></a></li></ul></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../dynamicssimulations/dynamicssimulations.html">Introduction</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/classical.html">Classical molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/ehrenfest.html">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/fssh.html">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/langevin.html">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/mdef.html">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/nrpmd.html">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpmd.html">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../dynamicssimulations/dynamicsmethods/rpsh.html">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../output_and_analysis/intro.html">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/reactive_scattering.html">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../examples/spinboson.html">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../examples/threestatemorse.html">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../examples/tully_scattering.html">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../integration_algorithms.html">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../devdocs/diffeq.html">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../devdocs/models.html">Implementing a new model</a></li><li><a class="tocitem" href="../devdocs/new_methods.html">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCBase/nqcbase.html">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCModels/adiabaticmodels.html">AdiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/cubeldfamodel.html">CubeLDFAModel</a></li><li><a class="tocitem" href="../api/NQCModels/diabaticmodels.html">DiabaticModels</a></li><li><a class="tocitem" href="../api/NQCModels/frictionmodels.html">FrictionModels</a></li><li><a class="tocitem" href="../api/NQCModels/mace.html">MACE interface</a></li><li><a class="tocitem" href="../api/NQCModels/nninterfaces.html">NNInterfaces</a></li><li><a class="tocitem" href="../api/NQCModels/nonadiabaticmodels.html">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCDistributions/nqcdistributions.html">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/NQCDynamics/analysis.html">Analysis</a></li><li><a class="tocitem" href="../api/NQCDynamics/calculators.html">Calculators</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsmethods.html">DynamicsMethods</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsoutputs.html">DynamicsOutputs</a></li><li><a class="tocitem" href="../api/NQCDynamics/dynamicsutils.html">DynamicsUtils</a></li><li><a class="tocitem" href="../api/NQCDynamics/ensembles.html">Ensembles</a></li><li><a class="tocitem" href="../api/NQCDynamics/estimators.html">Estimators</a></li><li><a class="tocitem" href="../api/NQCDynamics/initialconditions.html">InitialConditions</a></li><li><a class="tocitem" href="../api/NQCDynamics/nonadiabaticmoleculardynamics.html">NQCDynamics</a></li><li><a class="tocitem" href="../api/NQCDynamics/numericutils.html">Numerical utilities</a></li><li><a class="tocitem" href="../api/NQCDynamics/ringpolymers.html">RingPolymers</a></li><li><a class="tocitem" href="../api/NQCDynamics/structure.html">Structure</a></li><li><a class="tocitem" href="../api/NQCDynamics/timecorrelationfunctions.html">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../references.html">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Initial conditions</a></li><li class="is-active"><a href="metropolishastings.html">Thermal Metropolis-Hastings Monte Carlo</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="metropolishastings.html">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/initialconditions/metropolishastings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mhmc-sampling"><a class="docs-heading-anchor" href="#mhmc-sampling">Thermal Metropolis-Hastings Monte Carlo</a><a id="mhmc-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#mhmc-sampling" title="Permalink"></a></h1><p>Metropolis-Hastings Monte Carlo is a popular method for sampling the canonical distribution for a molecular system. Our implementations uses <a href="https://github.com/TuringLang/AdvancedMH.jl"><code>AdvancedMH.jl</code></a> from the <a href="https://turing.ml/stable/">Turing</a> organisation.</p><p>For a classical <code>Simulation</code>, the algorithm involves proposing new configurations in a random walk starting from an initial configuration. These are accepted or rejected based upon the Metropolis-Hastings criteria. The result is a Markov chain that samples the canonical distribution.</p><p>!!! Legacy version</p><pre><code class="nohighlight hljs">Prior to the use of [`AdvancedMH.jl`](https://github.com/TuringLang/AdvancedMH.jl),
an alternative version of the algorithm was implemented that works for both classical
and ring polymer systems: `MetropolisHastings.run_monte_carlo_sampling(sim, R0, Δ, passes)`

This is currently still included in the code but should be regarded as deprecated and
will likely be removed/combined with the [`AdvancedMH.jl`](https://github.com/TuringLang/AdvancedMH.jl)
version.</code></pre><h2 id="Example-1"><a class="docs-heading-anchor" href="#Example-1">Example 1</a><a id="Example-1-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1" title="Permalink"></a></h2><p>We can perform the sampling by setting up a classical simulation in the usual way and providing an appropriate initial configuration.</p><pre><code class="language-julia hljs">using NQCDynamics
sim = Simulation(Atoms([:H, :H, :H, :H, :H]), Harmonic(); temperature=15)
r0 = zeros(size(sim))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×5 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0</code></pre><p>Then we must also specify the total number of steps and the size of each step. These can be provided in a dictionary for each species to allow for different step sizes depending on the element in the simulation.</p><pre><code class="language-julia hljs">steps = 1e4
step_size = Dict(:H=&gt;1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Symbol, Int64} with 1 entry:
  :H =&gt; 1</code></pre><p>Now we can run the sampling. The extra keyword argument <code>movement_ratio</code> is used to specify the fraction of the system moved during each Monte Carlo step. If we attempt to move the entire system at once, we can expect a very low acceptance ratio, whereas is we move only a single atom, the sampling will take much longer. You will likely have to experiment with this parameter to achieve optimal sampling.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Keyword arguments relating to how much of the system to sample were recently changed. The existing <code>move_ratio</code> and <code>internal_ratio</code> arguments are no longer used. </p><p>Instead, there are now two options to specify how much of the system to move:</p><p><code>movement_ratio</code>: Defines which fraction of the system to move. 1 moves the entire system. </p><p><code>stop_ratio</code>: Defines which fraction of the system <em>not</em> to move. 1 stops the entire system. </p><p><code>movement_ratio_internal</code>: Defines which proportion of ring polymer normal modes to perturb. 1 moves the entire system. </p><p><code>stop_ratio_internal</code>: Defines which proportion of ring polymer normal modes not to perturb. 1 stops the entire system. </p></div></div><pre><code class="language-julia hljs">using NQCDynamics.InitialConditions: ThermalMonteCarlo
chain = ThermalMonteCarlo.run_advancedmh_sampling(sim, r0, steps, step_size; movement_ratio=0.5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10000-element Vector{Matrix{Float64}}:
 [0.0 0.0 … 0.0 0.0]
 [0.0 0.0 … 0.0 0.0]
 [0.0 0.0 … 0.0 0.0]
 [0.0 0.0 … -0.44567959197098145 0.0]
 [0.0 -0.4320781922071182 … -0.894023099409679 0.8194706489396713]
 [0.0 -0.4320781922071182 … -0.894023099409679 0.8194706489396713]
 [0.0 -1.3675558745601275 … 0.2440780391006392 1.2973503690378485]
 [0.0 -2.319169002345963 … -0.45568598789592685 1.2973503690378485]
 [1.1448013456999855 -1.545381868210688 … -0.07509433662861825 1.2973503690378485]
 [1.1448013456999855 -1.545381868210688 … -0.07509433662861825 1.2973503690378485]
 ⋮
 [4.996909581545353 -1.8841535841353347 … -0.22052883553623487 2.9245205918426818]
 [4.996909581545353 -1.8841535841353347 … -0.40929835197438785 2.9245205918426818]
 [4.996909581545353 -1.8841535841353347 … -0.40929835197438785 2.9245205918426818]
 [4.996909581545353 -1.8841535841353347 … -1.8034371075307751 2.7759870952365957]
 [4.996909581545353 -1.8841535841353347 … -1.8034371075307751 2.7759870952365957]
 [3.842209865067903 -1.8841535841353347 … -1.8034371075307751 0.9496381982575581]
 [3.8300529205393965 -3.384844319125712 … -1.8034371075307751 0.9496381982575581]
 [3.3716835284229223 -3.384844319125712 … -1.8034371075307751 0.30652699925222715]
 [2.8252606762440866 -2.300113022195857 … -3.186630307699628 0.30652699925222715]</code></pre><p>Now that our sampling is complete we can evaluate the potential energy expectation value. Here we use the <a href="../api/NQCDynamics/estimators.html#NQCDynamics.Estimators.@estimate-Tuple{Any}"><code>@estimate</code></a> macro which will evaluate the given function for every configuration inside <code>chain</code> and return the average. Here we can see that the energy we obtain closely matches that predicted by the equipartition theorem.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Estimators.@estimate potential_energy(sim, chain)</code><code class="nohighlight hljs ansi" style="display:block;">40.12718619902335</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sim.temperature / 2 * 5</code><code class="nohighlight hljs ansi" style="display:block;">37.5</code></pre><h2 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example 2</a><a id="Example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h2><p>Here, we obtain a thermal distribution in a simple model system with some additional tweaks to  try and sample a larger configuration space.</p><p>First we set up the system in the usual way, here we&#39;re using an NO molecule with a harmonic interaction between the atoms. Notice that we use <code>Unitful.jl</code> to specify the temperature.</p><pre><code class="language-julia hljs">using Unitful

atoms = Atoms([:N, :O])
model = DiatomicHarmonic(1.0)

sim = Simulation{Classical}(atoms, model; temperature=300u&quot;K&quot;)</code></pre><p>Then we have to specify the parameters for the Monte Carlo simulation and perform the sampling. <code>Δ</code> contains the step sizes for each of the species, <code>R0</code> the initial geometry and <code>samples</code> the number of configurations we want to obtain. </p><p><em>AdvancedMH.jl</em> provides some additional options to control the sampling process. To (hopefully) include  a larger configuration space in the final results, we set a <code>thinning</code> of 10, meaning that we only keep   every 10th proposed configuration. In addition, we discard the first 100 samples, since our initial configuration might not  lie in the equilibrium. This is set with <code>discard_initial</code>.  Further explanations of the keyword arguments can be found in the <em>AbstractMCMC.jl</em> <a href="https://turinglang.org/AbstractMCMC.jl/dev/api/#Common-keyword-arguments">documentation</a>.</p><pre><code class="language-julia hljs">Δ = Dict(:N =&gt; 0.1, :O =&gt; 0.1)
R0 = [1.0 0.0; 0.0 0.0; 0.0 0.0]
samples = 1000
output = InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling(sim, R0, samples, Δ; movement_ratio=0.5, thinning=10, discard_initial=100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32">Sampling   0%|                                          |  ETA: N/A</span>
<span class="sgr32">Sampling   0%|▎                                         |  ETA: 0:00:03</span>
<span class="sgr32">Sampling   1%|▍                                         |  ETA: 0:00:02</span>
<span class="sgr32">Sampling   1%|▋                                         |  ETA: 0:00:02</span>
<span class="sgr32">Sampling   2%|▉                                         |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   2%|█                                         |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   3%|█▎                                        |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   3%|█▌                                        |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   4%|█▋                                        |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   4%|█▉                                        |  ETA: 0:00:01</span>
<span class="sgr32">Sampling   5%|██▏                                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   5%|██▎                                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   6%|██▌                                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   6%|██▊                                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   7%|██▉                                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   7%|███▏                                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   8%|███▍                                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   8%|███▌                                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   9%|███▊                                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling   9%|████                                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  10%|████▏                                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  10%|████▍                                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  11%|████▋                                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  11%|████▊                                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  12%|█████                                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  12%|█████▎                                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  13%|█████▍                                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  13%|█████▋                                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  14%|█████▉                                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  14%|██████                                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  15%|██████▎                                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  15%|██████▌                                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  16%|██████▋                                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  16%|██████▉                                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  17%|███████▏                                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  17%|███████▎                                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  18%|███████▌                                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  18%|███████▊                                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  19%|███████▉                                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  19%|████████▏                                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  20%|████████▍                                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  20%|████████▌                                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  21%|████████▊                                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  21%|█████████                                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  22%|█████████▏                                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  22%|█████████▍                                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  23%|█████████▋                                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  23%|█████████▊                                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  24%|██████████                                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  24%|██████████▎                               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  25%|██████████▍                               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  25%|██████████▋                               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  26%|██████████▉                               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  26%|███████████                               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  27%|███████████▎                              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  27%|███████████▌                              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  28%|███████████▋                              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  28%|███████████▉                              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  29%|████████████▏                             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  29%|████████████▎                             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  30%|████████████▌                             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  30%|████████████▊                             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  31%|████████████▉                             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  31%|█████████████▏                            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  32%|█████████████▍                            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  32%|█████████████▌                            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  33%|█████████████▊                            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  33%|██████████████                            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  34%|██████████████▏                           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  34%|██████████████▍                           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  35%|██████████████▋                           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  35%|██████████████▊                           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  36%|███████████████                           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  36%|███████████████▎                          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  37%|███████████████▍                          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  37%|███████████████▋                          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  38%|███████████████▉                          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  38%|████████████████                          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  39%|████████████████▎                         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  39%|████████████████▌                         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  40%|████████████████▋                         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  40%|████████████████▉                         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  41%|█████████████████▏                        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  41%|█████████████████▎                        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  42%|█████████████████▌                        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  42%|█████████████████▊                        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  43%|█████████████████▉                        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  43%|██████████████████▏                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  44%|██████████████████▍                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  44%|██████████████████▌                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  45%|██████████████████▊                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  45%|███████████████████                       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  46%|███████████████████▏                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  46%|███████████████████▍                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  47%|███████████████████▌                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  47%|███████████████████▊                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  48%|████████████████████                      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  48%|████████████████████▏                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  49%|████████████████████▍                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  49%|████████████████████▋                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  50%|████████████████████▊                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  50%|█████████████████████                     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  51%|█████████████████████▎                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  51%|█████████████████████▍                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  52%|█████████████████████▋                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  52%|█████████████████████▉                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  53%|██████████████████████                    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  53%|██████████████████████▎                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  54%|██████████████████████▌                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  54%|██████████████████████▋                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  55%|██████████████████████▉                   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  55%|███████████████████████▏                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  55%|███████████████████████▎                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  56%|███████████████████████▌                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  56%|███████████████████████▊                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  57%|███████████████████████▉                  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  57%|████████████████████████▏                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  58%|████████████████████████▍                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  58%|████████████████████████▌                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  59%|████████████████████████▊                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  59%|█████████████████████████                 |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  60%|█████████████████████████▏                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  60%|█████████████████████████▍                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  61%|█████████████████████████▋                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  61%|█████████████████████████▊                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  62%|██████████████████████████                |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  62%|██████████████████████████▎               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  63%|██████████████████████████▍               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  63%|██████████████████████████▋               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  64%|██████████████████████████▉               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  64%|███████████████████████████               |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  65%|███████████████████████████▎              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  65%|███████████████████████████▌              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  66%|███████████████████████████▋              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  66%|███████████████████████████▉              |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  67%|████████████████████████████▏             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  67%|████████████████████████████▎             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  68%|████████████████████████████▌             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  68%|████████████████████████████▊             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  69%|████████████████████████████▉             |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  69%|█████████████████████████████▏            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  70%|█████████████████████████████▍            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  70%|█████████████████████████████▌            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  71%|█████████████████████████████▊            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  71%|██████████████████████████████            |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  72%|██████████████████████████████▏           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  72%|██████████████████████████████▍           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  73%|██████████████████████████████▋           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  73%|██████████████████████████████▊           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  74%|███████████████████████████████           |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  74%|███████████████████████████████▎          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  75%|███████████████████████████████▍          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  75%|███████████████████████████████▋          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  76%|███████████████████████████████▉          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  76%|████████████████████████████████          |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  77%|████████████████████████████████▎         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  77%|████████████████████████████████▌         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  78%|████████████████████████████████▋         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  78%|████████████████████████████████▉         |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  79%|█████████████████████████████████▏        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  79%|█████████████████████████████████▎        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  80%|█████████████████████████████████▌        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  80%|█████████████████████████████████▊        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  81%|█████████████████████████████████▉        |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  81%|██████████████████████████████████▏       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  82%|██████████████████████████████████▍       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  82%|██████████████████████████████████▌       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  83%|██████████████████████████████████▊       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  83%|███████████████████████████████████       |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  84%|███████████████████████████████████▏      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  84%|███████████████████████████████████▍      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  85%|███████████████████████████████████▋      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  85%|███████████████████████████████████▊      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  86%|████████████████████████████████████      |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  86%|████████████████████████████████████▎     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  87%|████████████████████████████████████▍     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  87%|████████████████████████████████████▋     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  88%|████████████████████████████████████▉     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  88%|█████████████████████████████████████     |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  89%|█████████████████████████████████████▎    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  89%|█████████████████████████████████████▌    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  90%|█████████████████████████████████████▋    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  90%|█████████████████████████████████████▉    |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  91%|██████████████████████████████████████▏   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  91%|██████████████████████████████████████▎   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  92%|██████████████████████████████████████▌   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  92%|██████████████████████████████████████▊   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  93%|██████████████████████████████████████▉   |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  93%|███████████████████████████████████████▏  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  94%|███████████████████████████████████████▍  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  94%|███████████████████████████████████████▌  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  95%|███████████████████████████████████████▊  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  95%|████████████████████████████████████████  |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  96%|████████████████████████████████████████▏ |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  96%|████████████████████████████████████████▍ |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  97%|████████████████████████████████████████▋ |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  97%|████████████████████████████████████████▊ |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  98%|█████████████████████████████████████████ |  ETA: 0:00:00</span>
<span class="sgr32">Sampling  98%|█████████████████████████████████████████▎|  ETA: 0:00:00</span>
<span class="sgr32">Sampling  99%|█████████████████████████████████████████▍|  ETA: 0:00:00</span>
<span class="sgr32">Sampling  99%|█████████████████████████████████████████▋|  ETA: 0:00:00</span>
<span class="sgr32">Sampling 100%|█████████████████████████████████████████▉|  ETA: 0:00:00</span>
<span class="sgr90">Sampling 100%|██████████████████████████████████████████| Time: 0:00:00</span></code></pre><p>We can calculate the distance between each atom and plot the bond length throughout the sampling.</p><pre><code class="language-julia hljs">using LinearAlgebra
plot([norm(R[:,1] .- R[:,2]) for R in output])</code></pre><img src="metropolishastings-92d809f6.svg" alt="Example block output"/><p>The result of this simulation seamlessly interfaces with the <code>DynamicalDistribution</code> presented in the previous section and <code>output</code> can be readily passed to provide the position distribution. The Monte Carlo sampling does not include velocities but these can be readily obtained from the Maxwell-Boltzmann distribution.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="langevin.html">« Thermal Langevin dynamics</a><a class="docs-footer-nextpage" href="../dynamicssimulations/dynamicssimulations.html">Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 16 July 2024 10:49">Tuesday 16 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
