<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NQCDistributions.jl · NQCDynamics.jl</title><meta name="title" content="NQCDistributions.jl · NQCDynamics.jl"/><meta property="og:title" content="NQCDistributions.jl · NQCDynamics.jl"/><meta property="twitter:title" content="NQCDistributions.jl · NQCDynamics.jl"/><meta name="description" content="Documentation for NQCDynamics.jl."/><meta property="og:description" content="Documentation for NQCDynamics.jl."/><meta property="twitter:description" content="Documentation for NQCDynamics.jl."/><meta property="og:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/NQCDistributions/overview/"/><meta property="twitter:url" content="https://nqcd.github.io/NQCDynamics.jl/stable/NQCDistributions/overview/"/><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/NQCDistributions/overview/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NQCDynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../../NQCModels/combining_models/">Composing multiple models</a></li><li><a class="tocitem" href="../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../NQCModels/machinelearningmodels/">Machine learning interatomic potentials</a></li><li><a class="tocitem" href="../../NQCModels/fullsizemodels/">Full dimensional model library</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">NQCDistributions.jl</span><ul><li class="is-active"><a class="tocitem" href>NQCDistributions.jl</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Storing-and-sampling-distributions"><span>Storing and sampling distributions</span></a></li><li><a class="tocitem" href="#Nuclear-Distributions-using-DynamicalDistribution"><span>Nuclear Distributions using <code>DynamicalDistribution</code></span></a></li><li><a class="tocitem" href="#Electronic-distributions"><span>Electronic distributions</span></a></li><li><a class="tocitem" href="#Product-distributions-Combining-Nuclear-and-electronic-distributions"><span>Product distributions - Combining Nuclear and electronic distributions</span></a></li></ul></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../initialconditions/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../initialconditions/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../initialconditions/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../initialconditions/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Outputs and Analysis</span><ul><li><a class="tocitem" href="../../output_and_analysis/intro/">Simulations outputs and analysis functions</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/mdef_multithermostat/">MDEF with the Two-temperature model and separate Electron and Phonon Thermostats</a></li><li><a class="tocitem" href="../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><a class="tocitem" href="../../integration_algorithms/">Integration algorithms</a></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-14-1" type="checkbox"/><label class="tocitem" for="menuitem-14-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-2" type="checkbox"/><label class="tocitem" for="menuitem-14-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCModels/FrictionProviders/">FrictionModels</a></li><li><a class="tocitem" href="../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../api/NQCModels/frictionmodels/">FrictionProviders.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/mace/">MACEModels.jl</a></li><li><a class="tocitem" href="../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-3" type="checkbox"/><label class="tocitem" for="menuitem-14-3"><span class="docs-label">NQCDistributions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDistributions/nqcdistributions/">NQCDistributions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-14-4" type="checkbox"/><label class="tocitem" for="menuitem-14-4"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/NQCDynamics/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../api/NQCDynamics/numericutils/">Numerical utilities</a></li><li><a class="tocitem" href="../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../api/NQCDynamics/structure/">Structure</a></li><li><a class="tocitem" href="../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">NQCDistributions.jl</a></li><li class="is-active"><a href>NQCDistributions.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>NQCDistributions.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/main/docs/src/NQCDistributions/overview.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="NQCDistributions.jl"><a class="docs-heading-anchor" href="#NQCDistributions.jl">NQCDistributions.jl</a><a id="NQCDistributions.jl-1"></a><a class="docs-heading-anchor-permalink" href="#NQCDistributions.jl" title="Permalink"></a></h1><h1 id="Storing-and-sampling-distributions"><a class="docs-heading-anchor" href="#Storing-and-sampling-distributions">Storing and sampling distributions</a><a id="Storing-and-sampling-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Storing-and-sampling-distributions" title="Permalink"></a></h1><p>In order to perform ensembles of trajectories, it is useful to have a convenient way to generate distributions of velocities and positions which can be sampled to initialise trajectories. The <a href="https://github.com/NQCD/NQCDistributions.jl">NQCDistributions.jl</a> package contains the types and functions that seek to address this requirement as painlessly as possible. </p><p>For quantum classical nonadiabatic dynamics simulations, the initial distributions contain both nuclear and electronic degrees of freedom.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Currently, we allow for <em>product distributions</em> only, where the nuclear and electronic distributions are separable. In the future it would be great to remove this restriction, if you are interested, please open an issue on GitHub.</p></div></div><p>This page describes the types that can be used to represent nuclear and electronic distributions and demonstrates how they can be combined into a product distribution.</p><h2 id="Nuclear-Distributions-using-DynamicalDistribution"><a class="docs-heading-anchor" href="#Nuclear-Distributions-using-DynamicalDistribution">Nuclear Distributions using <code>DynamicalDistribution</code></a><a id="Nuclear-Distributions-using-DynamicalDistribution-1"></a><a class="docs-heading-anchor-permalink" href="#Nuclear-Distributions-using-DynamicalDistribution" title="Permalink"></a></h2><p>When handling distributions for the nuclear degrees of freedom, the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a> type can be used to store initial velocities and positions:</p><pre><code class="language-julia hljs">d = DynamicalDistribution(10, 5, (3, 2))</code></pre><p>Here, we have created a delta distribution with fixed velocities and positions, the final argument specifies the size of each sample. The <code>(3, 2)</code> case shown here would be appropriate when using 2 atoms each with 3 degrees of freedom.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; rand(d)</code><code class="nohighlight hljs ansi" style="display:block;">ComponentVector{Int64}(v = [10 10; 10 10; 10 10], r = [5 5; 5 5; 5 5])</code></pre><p><a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a> is flexible and each of the first two arguments can be <code>Real</code>, <code>Vector</code> or <code>Sampleable</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ul><li><code>Real</code>s are used whenever the same value is desired for every sample, as above.</li><li><code>Vector</code>s can be provided when sampling a provided vector of configurations.</li><li><code>Sampleable</code>s are provided by <code>Distributions.jl</code> and can be used when specifying an   analytic distribution such as the Maxwell-Boltzmann distribution for velocities.</li></ul></div></div><p>Each of these options can be composed in any combination, let&#39;s see the case where we have an analytic distribution of positions and a preset collection of velocities:</p><pre><code class="language-julia hljs">using Distributions

velocity = [[1.0 1.0;1.0 1.0], [2.0 2.0; 2.0 2.0], [3.0 3.0; 3.0 3.0]]
position = Normal()
d = DynamicalDistribution(velocity, position, (2, 2))
rand(d)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ComponentVector{Float64}(v = [1.0 1.0; 1.0 1.0], r = [-0.07058313895389791 -0.806852326006714; 0.5314767537831963 2.456991333983293])</code></pre><p>This has generated normally distributed positions along with one of the three velocities we provided.</p><h3 id="Sampling-the-nuclear-distribution"><a class="docs-heading-anchor" href="#Sampling-the-nuclear-distribution">Sampling the nuclear distribution</a><a id="Sampling-the-nuclear-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-the-nuclear-distribution" title="Permalink"></a></h3><p>To learn how to generate configurations to use with the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a>, read on to the next sections about the included sampling methods.</p><h3 id="VelocityBoltzmann"><a class="docs-heading-anchor" href="#VelocityBoltzmann">VelocityBoltzmann</a><a id="VelocityBoltzmann-1"></a><a class="docs-heading-anchor-permalink" href="#VelocityBoltzmann" title="Permalink"></a></h3><p>When performing equilibrium simulations it is often desirable to initialise trajectories with thermal velocities, e.g. in combination with positions obtained from Monte Carlo sampling. These can be obtained for each atom from a gaussian distribution of the appropriate width, or alternatively, using the <a href="#VelocityBoltzmann"><code>VelocityBoltzmann</code></a> distribution which simplifies the process. This takes the temperature, masses and size of the system and ensures the samples you obtain are of the correct shape:</p><pre><code class="language-julia hljs">using NQCDynamics
using Unitful

velocity = VelocityBoltzmann(300u&quot;K&quot;, rand(10), (3, 10))
rand(velocity)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×10 Matrix{Float64}:
 -0.0137482   0.0327169   -0.0257383  …   0.0224053   -0.0451373   0.0238809
 -0.0098332   0.0137217    0.034586      -0.0801163   -0.0412374  -0.0231699
  0.00709438  0.00314034  -0.0135362     -0.00572235   0.0206773   0.019912</code></pre><p><a href="#VelocityBoltzmann"><code>VelocityBoltzmann</code></a> can also be called with a <a href="../../getting_started/#Simulation"><code>Simulation</code></a>, since this contains  both the atomic masses and the desired dimensions of the system.</p><p>If the <code>Simulation</code> was set up with a <code>Model</code> which implements <code>NQCModels.mobileatoms</code>, <em>immobile</em> atoms  are correctly initialised with zero velocity. </p><p>The resulting distribution can be handed directly to the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a> when Boltzmann velocities are required.</p><pre><code class="language-julia hljs">distribution = DynamicalDistribution(velocity, 1, (3, 10))
rand(distribution)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ComponentVector{Float64}(v = [0.027331716537782148 -0.0021026361976499075 … -0.00387292345262294 0.07335473249731836; 0.002132155711057304 0.03583720339431344 … 0.04176756764831186 -0.03446977999414407; 0.0637288037075385 -0.048215784327210146 … -0.03132857040941509 -0.0022365440103764025], r = [1.0 1.0 … 1.0 1.0; 1.0 1.0 … 1.0 1.0; 1.0 1.0 … 1.0 1.0])</code></pre><h3 id="Wigner-distributions"><a class="docs-heading-anchor" href="#Wigner-distributions">Wigner distributions</a><a id="Wigner-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Wigner-distributions" title="Permalink"></a></h3><p>For harmonic oscillator systems, we have implemented the analytic Wigner distribution. These are just mormal distributions of the appropriate width but can be accessed easily as in the following:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NQCDistributions</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; omega = 1.0;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; beta = 1e-3;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mass = 10;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dist = PositionHarmonicWigner(omega, beta, mass, centre=0.0)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=0.0, σ=10.000000416666651)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rand(dist)</code><code class="nohighlight hljs ansi" style="display:block;">6.600364169139143</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dist = VelocityHarmonicWigner(omega, beta, mass)</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=0.0, σ=10.000000416666651)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rand(dist)</code><code class="nohighlight hljs ansi" style="display:block;">-4.7797282117367175</code></pre><p>These can also be given to the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.DynamicalDistribution"><code>DynamicalDistribution</code></a> since they are just univariate normal distributions.</p><h3 id="Nuclear-distributions-for-Ring-polymer-simulations"><a class="docs-heading-anchor" href="#Nuclear-distributions-for-Ring-polymer-simulations">Nuclear distributions for Ring polymer simulations</a><a id="Nuclear-distributions-for-Ring-polymer-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Nuclear-distributions-for-Ring-polymer-simulations" title="Permalink"></a></h3><p>The components making up a <code>DynamicalDistribution</code> can all be adapted for use in Ring Polymer simulations. </p><p>For samplable components based on nuclear configurations, simply use three-dimensional arrays instead of two-dimensional ones. </p><p>Pre-defined distribution functions such as <code>VelocityBoltzmann</code> can be turned into a three-dimensional version using the <code>RingPolymerWrapper</code>:</p><pre><code class="language-julia hljs">velocity = VelocityBoltzmann(300u&quot;K&quot;, rand(10), (3, 10))
velocity_ring_polymer = RingPolymerWrapper(velocity, n_beads, Int[]) # RingPolymerWrapper(Distribution, number of ring-polymer beads, indices of atoms to treat classically)</code></pre><h2 id="Electronic-distributions"><a class="docs-heading-anchor" href="#Electronic-distributions">Electronic distributions</a><a id="Electronic-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Electronic-distributions" title="Permalink"></a></h2><p>For nonadiabatic dynamics, the initial electronic variables must also be sampled. For this, we can use an <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.ElectronicDistribution"><code>ElectronicDistribution</code></a> which will tell our simulation how we want to sample the initial variables. Currently, two of these are provided, the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.PureState"><code>PureState</code></a> and the <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.MixedState"><code>MixedState</code></a>. The <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.PureState"><code>PureState</code></a> is used for nonequilibrium simulations when the population is confined to a single state, whereas <a href="../../api/NQCDistributions/nqcdistributions/#NQCDistributions.MixedState"><code>MixedState</code></a> allows for a mixed state distribution.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NQCDistributions</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; PureState(1, Diabatic())</code><code class="nohighlight hljs ansi" style="display:block;">PureState{Diabatic}(1, Diabatic())</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; PureState(2, Adiabatic())</code><code class="nohighlight hljs ansi" style="display:block;">PureState{Adiabatic}(2, Adiabatic())</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; MixedState([1, 2], Diabatic())</code><code class="nohighlight hljs ansi" style="display:block;">MixedState{Int64, Diabatic}([1, 2], Diabatic())</code></pre><p>These structs contain only the minimal information about the distributions, whereas the sampling of the distribution is handled separately by each of the different methods.</p><h2 id="Product-distributions-Combining-Nuclear-and-electronic-distributions"><a class="docs-heading-anchor" href="#Product-distributions-Combining-Nuclear-and-electronic-distributions">Product distributions - Combining Nuclear and electronic distributions</a><a id="Product-distributions-Combining-Nuclear-and-electronic-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Product-distributions-Combining-Nuclear-and-electronic-distributions" title="Permalink"></a></h2><p>The initial nuclear and electronic states of a system can be combined in a product distribution, which can be used in place of a purely nuclear distribution for methods considering electronic dynamics.</p><pre><code class="language-julia hljs">nuclear_dist = DynamicalDistribution(velocity, position, (2, 2))
electronic_dist = PureState(2, Adiabatic())

total_dist = nuclear_dist * electronic_dist

rand(total_dist.nuclear) # Returns a random nuclear configuration

total_dist.electronic.state # Returns the chosen electronic state. 
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../NQCModels/frictionmodels/">« Electronic friction models</a><a class="docs-footer-nextpage" href="../../initialconditions/ebk/">Semiclassical EBK quantisation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 4 March 2025 00:49">Tuesday 4 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
