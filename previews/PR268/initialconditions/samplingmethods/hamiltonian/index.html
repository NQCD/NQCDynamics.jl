<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermal Hamiltonian Monte Carlo · NQCDynamics.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/initialconditions/samplingmethods/hamiltonian/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../../../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../dynamicaldistribution/">Storing and sampling distributions</a></li><li><a class="tocitem" href="../ebk/">Semiclassical EBK quantisation</a></li><li class="is-active"><a class="tocitem" href>Thermal Hamiltonian Monte Carlo</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-11-1" type="checkbox"/><label class="tocitem" for="menuitem-11-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../../api/NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../../api/NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../../api/NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../../api/NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../../api/NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox"/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/NQCDynamics/calculators/">Calculators</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/ensembles/">Ensembles</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/estimators/">Estimators</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/initialconditions/">InitialConditions</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/nonadiabaticdistributions/">NonadiabaticDistributions</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../../../api/NQCDynamics/timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Initial conditions</a></li><li class="is-active"><a href>Thermal Hamiltonian Monte Carlo</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Thermal Hamiltonian Monte Carlo</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/master/docs/src/initialconditions/samplingmethods/hamiltonian.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="hmc-sampling"><a class="docs-heading-anchor" href="#hmc-sampling">Thermal Hamiltonian Monte Carlo</a><a id="hmc-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#hmc-sampling" title="Permalink"></a></h1><p>Our implementation of Hamiltonian Monte Carlo (HMC) is a light wrapper around the <a href="https://github.com/TuringLang/AdvancedHMC.jl">AdvancedHMC.jl</a> package. If you want to learn about the HMC theory, refer to the references and documentation provided with <a href="https://github.com/TuringLang/AdvancedHMC.jl">AdvancedHMC.jl</a>.</p><p>Currently, our implementation works for systems with classical nuclei only (i.e. <code>Simulation</code> but not <code>RingPolymerSimulation</code>).</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>In this example we use Hamiltonian Monte Carlo to sample the canonical distribution of a 3 dimensional harmonic oscillator potential containing 4 atoms.</p><pre><code class="language-julia hljs">using NQCDynamics
using Unitful
using UnitfulAtomic

sim = Simulation(Atoms([:H, :H, :C, :C]), Harmonic(dofs=3); temperature=300u&quot;K&quot;)
r0 = randn(size(sim))
chain, stats = InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling(sim, r0, 1e4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">┌ Info: </span></span>Finished 1000 adapation steps
<span class="sgr36"><span class="sgr1">│ </span></span>  adaptor =
<span class="sgr36"><span class="sgr1">│ </span></span>   StanHMCAdaptor(
<span class="sgr36"><span class="sgr1">│ </span></span>       pc=WelfordVar,
<span class="sgr36"><span class="sgr1">│ </span></span>       ssa=NesterovDualAveraging(γ=0.05, t_0=10.0, κ=0.75, δ=0.5, state.ϵ=0.9923112934123468),
<span class="sgr36"><span class="sgr1">│ </span></span>       init_buffer=75, term_buffer=50, window_size=25,
<span class="sgr36"><span class="sgr1">│ </span></span>       state=window(76, 950), window_splits(100, 150, 250, 450, 950)
<span class="sgr36"><span class="sgr1">│ </span></span>   )
<span class="sgr36"><span class="sgr1">│ </span></span>  κ.τ.integrator = Leapfrog(ϵ=0.992)
<span class="sgr36"><span class="sgr1">└ </span></span>  h.metric = DiagEuclideanMetric([0.0010494284996278255, 0.0 ...])
<span class="sgr36"><span class="sgr1">┌ Info: </span></span>Finished 10000 sampling steps for 1 chains in 1.954605674 (s)
<span class="sgr36"><span class="sgr1">│ </span></span>  h = Hamiltonian(metric=DiagEuclideanMetric([0.0010494284996278255, 0.0 ...]))
<span class="sgr36"><span class="sgr1">│ </span></span>  κ = AdvancedHMC.HMCKernel{AdvancedHMC.FullMomentumRefreshment, AdvancedHMC.Trajectory{AdvancedHMC.MultinomialTS, AdvancedHMC.Leapfrog{Float64}, AdvancedHMC.GeneralisedNoUTurn{Float64}}}(AdvancedHMC.FullMomentumRefreshment(), Trajectory{AdvancedHMC.MultinomialTS}(integrator=Leapfrog(ϵ=0.992), tc=AdvancedHMC.GeneralisedNoUTurn{Float64}(10, 1000.0)))
<span class="sgr36"><span class="sgr1">│ </span></span>  EBFMI_est = 0.45697408349967467
<span class="sgr36"><span class="sgr1">└ </span></span>  average_acceptance_rate = 0.6836764098672842</code></pre><p>The Monte Carlo <code>chain</code> contains the nuclear configurations that we have sampled:</p><pre><code class="language-julia hljs">chain</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10000-element Vector{Matrix{Float64}}:
 [0.3933612168634253 0.4197412369605924 -0.09668702565691736 -0.11648638981181259; -0.13080708983130396 -0.5736440573102597 -0.2777691539885807 -0.3453046409825562; 0.3705637647766886 -0.15953332065841513 0.07430372862721352 0.24058034034783715]
 [0.3933612168634253 0.4197412369605924 -0.09668702565691736 -0.11648638981181259; -0.13080708983130396 -0.5736440573102597 -0.2777691539885807 -0.3453046409825562; 0.3705637647766886 -0.15953332065841513 0.07430372862721352 0.24058034034783715]
 [0.3933612168634253 0.4197412369605924 -0.09668702565691736 -0.11648638981181259; -0.13080708983130396 -0.5736440573102597 -0.2777691539885807 -0.3453046409825562; 0.3705637647766886 -0.15953332065841513 0.07430372862721352 0.24058034034783715]
 [0.3933612168634253 0.4197412369605924 -0.09668702565691736 -0.11648638981181259; -0.13080708983130396 -0.5736440573102597 -0.2777691539885807 -0.3453046409825562; 0.3705637647766886 -0.15953332065841513 0.07430372862721352 0.24058034034783715]
 [-0.12983691713893047 -0.14383835889165097 0.06933563812738756 0.028849064902498625; 0.05524239098830215 0.1882525364503599 0.0723168677723394 0.1950941079839335; -0.12797718734583144 0.01613893069371436 0.015583603151282488 -0.044793155280536484]
 [-0.12983691713893047 -0.14383835889165097 0.06933563812738756 0.028849064902498625; 0.05524239098830215 0.1882525364503599 0.0723168677723394 0.1950941079839335; -0.12797718734583144 0.01613893069371436 0.015583603151282488 -0.044793155280536484]
 [-0.01347742151217822 -0.013978411846525637 0.021483736207445828 0.006325650598460176; 0.02423758459216381 -0.020891210459253073 -0.036786430549617076 0.04127332842555846; 0.005993489392223342 -0.03750758756860289 0.025745316714304516 -0.04002783312278253]
 [-0.01347742151217822 -0.013978411846525637 0.021483736207445828 0.006325650598460176; 0.02423758459216381 -0.020891210459253073 -0.036786430549617076 0.04127332842555846; 0.005993489392223342 -0.03750758756860289 0.025745316714304516 -0.04002783312278253]
 [0.01824631505407074 0.02953679316700445 -0.02332269655275372 -0.01028917542663664; -0.023756550436249878 -0.00012885984129282213 0.061590737570814715 -0.04271874769310746; -0.011739777870491134 0.015910950184244425 -0.036524341377514535 0.02388246062903127]
 [0.01824631505407074 0.02953679316700445 -0.02332269655275372 -0.01028917542663664; -0.023756550436249878 -0.00012885984129282213 0.061590737570814715 -0.04271874769310746; -0.011739777870491134 0.015910950184244425 -0.036524341377514535 0.02388246062903127]
 ⋮
 [-0.07020518814800186 -0.03129075652882708 -0.022474222611463562 -0.053744515076322254; -0.0016095958949271412 -0.0004836103678529796 0.052352150969031445 -0.020609960677973313; -0.05735823763945473 0.023572695396544774 -0.016229944197729437 -0.013649790087216389]
 [0.07807341314504178 0.029974796275369125 0.01899404784064926 0.04430374629836982; 0.001510658652653294 -0.01082660582765628 -0.05335621464239997 0.019472997958685172; 0.05848704201842455 -0.031329346164036126 0.013684480801017961 0.01272245843666029]
 [-0.04074704714846942 -0.03720931880219913 0.0038976443903694057 0.03630088728257482; -0.06934309625661063 -0.007470644439416843 0.05782599972603882 0.022316216481789695; -0.027182149026903874 0.009901528628467441 -0.035632228101431046 -0.03462733992744883]
 [0.03694532743636545 0.06567355581045088 -0.02815902263343839 -0.04718907196043098; 0.06677878419240753 -0.009783268101817146 -0.048681456767205276 0.03682710939939881; -0.01594712691547687 -0.009993956440283027 0.033818793405062796 0.023926023953330038]
 [0.013093354969218957 0.023116329865303244 -0.06297267024958447 -0.004058953702768611; -0.030059842084423596 0.017193879752404793 -0.05714957181183774 -0.04086906303621899; -0.046737767173465936 -0.022208283958202544 -0.013154711764090367 -0.025106506976609898]
 [-0.02701634155778465 -0.013176211357802618 0.06047382665877178 0.01304271915817239; 0.029542399030721603 -0.01921726645737942 0.05549797679635206 0.03706758220873815; 0.04263184295582866 0.021188059420892854 0.018232203881235524 0.02711941545528958]
 [0.017276325976242943 -0.00549647948917294 -0.02233868840145909 0.004083566925787888; 0.05823441148538338 0.02795968723115877 -0.03171139418395635 -0.04265140429495688; 0.03067115296802507 -0.02314090941023748 0.001412308818769005 0.01241346855562539]
 [-0.011267301447635502 0.01325579972973658 0.019157108946127634 0.008973574168764577; -0.05688056974516912 -0.02020963074626722 0.03161719504862974 0.039875277118473364; -0.027024279563075574 0.01720711242445574 -0.004184146019525485 -0.012125538247945473]
 [-0.006242692450723571 0.0022061424045673114 -0.046956074970496704 0.006709933130001044; -0.04813210437425677 0.016554656883903764 0.041216143043995096 -0.027790927749128592; 0.004476512824823049 -0.0039296534252799935 -0.02470479977210222 -0.03391009521017212]</code></pre><p>and <code>stats</code> contains extra information about the sampling procedure:</p><pre><code class="language-julia hljs">stats</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10000-element Vector{NamedTuple}:
 (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -590.7995660800503, hamiltonian_energy = 2145.8411998506635, hamiltonian_energy_error = -2981.5494065195517, max_hamiltonian_energy_error = -3071.6290084922352, tree_depth = 1, numerical_error = false, step_size = 0.05, nom_step_size = 0.05, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -590.7995660800503, hamiltonian_energy = 596.9375219113467, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.5702086910759314e11, tree_depth = 0, numerical_error = true, step_size = 1.241032542311506, nom_step_size = 1.241032542311506, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -590.7995660800503, hamiltonian_energy = 597.7356051590856, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.641753484941622e8, tree_depth = 0, numerical_error = true, step_size = 0.5, nom_step_size = 0.5, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -590.7995660800503, hamiltonian_energy = 595.5201962274303, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 179567.61974324155, tree_depth = 0, numerical_error = true, step_size = 0.13192866018819532, nom_step_size = 0.13192866018819532, is_adapt = true)
 (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -75.71068223649958, hamiltonian_energy = 485.1673544535005, hamiltonian_energy_error = -111.77275721836577, max_hamiltonian_energy_error = -111.77275721836577, tree_depth = 2, numerical_error = false, step_size = 0.028716309633808685, nom_step_size = 0.028716309633808685, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -75.71068223649958, hamiltonian_energy = 85.25715381222629, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 9283.877121702511, tree_depth = 0, numerical_error = true, step_size = 0.11260612534950616, nom_step_size = 0.11260612534950616, is_adapt = true)
 (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -4.561382735923864, hamiltonian_energy = 69.26606469639177, hamiltonian_energy_error = -10.251973436470706, max_hamiltonian_energy_error = -10.251973436470706, tree_depth = 2, numerical_error = false, step_size = 0.02340023160450795, nom_step_size = 0.02340023160450795, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -4.561382735923864, hamiltonian_energy = 17.26642499071425, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 916.5524724725642, tree_depth = 1, numerical_error = false, step_size = 0.10545494475829686, nom_step_size = 0.10545494475829686, is_adapt = true)
 (n_steps = 7, is_accept = true, acceptance_rate = 0.8742596118866128, log_density = -5.438301834260415, hamiltonian_energy = 10.493355186622313, hamiltonian_energy_error = 0.107494020705726, max_hamiltonian_energy_error = 0.272821730765358, tree_depth = 3, numerical_error = false, step_size = 0.021583114937805906, nom_step_size = 0.021583114937805906, is_adapt = true)
 (n_steps = 1, is_accept = true, acceptance_rate = 2.679244472442884e-16, log_density = -5.438301834260415, hamiltonian_energy = 11.636508009995698, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 35.85582664639456, tree_depth = 1, numerical_error = false, step_size = 0.06930976602643446, nom_step_size = 0.06930976602643446, is_adapt = true)
 ⋮
 (n_steps = 3, is_accept = true, acceptance_rate = 0.6410845994259232, log_density = -8.823361317612436, hamiltonian_energy = 13.831624459694662, hamiltonian_energy_error = 0.75693842772273, max_hamiltonian_energy_error = 0.7893202906631718, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.8529618283654088, log_density = -9.165112629744158, hamiltonian_energy = 16.272118670541843, hamiltonian_energy_error = 0.073993496528594, max_hamiltonian_energy_error = 0.4617057494402701, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.8719970968388298, log_density = -8.625686599906317, hamiltonian_energy = 16.33100659172771, hamiltonian_energy_error = -0.1193893365612837, max_hamiltonian_energy_error = 0.41855187481461087, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.8252393798152106, log_density = -10.025491909412846, hamiltonian_energy = 13.41472822811603, hamiltonian_energy_error = 0.4243085598290701, max_hamiltonian_energy_error = -1.3025313005630128, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.6103077009091039, log_density = -7.528297804404973, hamiltonian_energy = 17.643889618715136, hamiltonian_energy_error = -0.8296646721547276, max_hamiltonian_energy_error = 1.11962116641471, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.6319710928401719, log_density = -7.242333397345729, hamiltonian_energy = 16.019257823843546, hamiltonian_energy_error = -0.06635356375712931, max_hamiltonian_energy_error = 1.119496675081301, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.7621787738226082, log_density = -4.9863144604458585, hamiltonian_energy = 12.489919929819472, hamiltonian_energy_error = -0.5691198603928065, max_hamiltonian_energy_error = 0.7637126173100075, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.7288291103958885, log_density = -4.302241807052239, hamiltonian_energy = 10.576880439896808, hamiltonian_energy_error = -0.1570200088999556, max_hamiltonian_energy_error = 0.8832159303299498, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)
 (n_steps = 3, is_accept = true, acceptance_rate = 0.7067723668099578, log_density = -4.816253167118427, hamiltonian_energy = 9.554323263570847, hamiltonian_energy_error = 0.14590733612608808, max_hamiltonian_energy_error = 0.6489273083492684, tree_depth = 2, numerical_error = false, step_size = 0.9923112934123468, nom_step_size = 0.9923112934123468, is_adapt = false)</code></pre><p>Here we should see that the energy expectation for the generated ensemble matches with the equipartition theorem:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Estimators.@estimate potential_energy(sim, chain)</code><code class="nohighlight hljs ansi" style="display:block;">0.005954460347734838</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; austrip(sim.temperature) * 3 * 4 / 2</code><code class="nohighlight hljs ansi" style="display:block;">0.005700260814198945</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ebk/">« Semiclassical EBK quantisation</a><a class="docs-footer-nextpage" href="../langevin/">Thermal Langevin dynamics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Tuesday 22 March 2022 10:49">Tuesday 22 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
