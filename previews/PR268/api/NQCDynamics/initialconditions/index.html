<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>InitialConditions · NQCDynamics.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://nqcd.github.io/NQCDynamics.jl/stable/api/NQCDynamics/initialconditions/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="NQCDynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">NQCDynamics.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../../atoms/">Atoms</a></li><li><a class="tocitem" href="../../../ensemble_simulations/">Ensemble simulations</a></li><li><a class="tocitem" href="../../../saving_loading/">Saving and loading</a></li><li><span class="tocitem">NQCModels.jl</span><ul><li><a class="tocitem" href="../../../NQCModels/overview/">NQCModels.jl</a></li><li><a class="tocitem" href="../../../NQCModels/analyticmodels/">Analytic model library</a></li><li><a class="tocitem" href="../../../NQCModels/ase/">ASE interface</a></li><li><a class="tocitem" href="../../../NQCModels/neuralnetworkmodels/">Neural network models</a></li><li><a class="tocitem" href="../../../NQCModels/frictionmodels/">Electronic friction models</a></li></ul></li><li><span class="tocitem">Initial conditions</span><ul><li><a class="tocitem" href="../../../initialconditions/dynamicaldistribution/">Storing and sampling distributions</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/ebk/">Semiclassical EBK quantisation</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/hamiltonian/">Thermal Hamiltonian Monte Carlo</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/langevin/">Thermal Langevin dynamics</a></li><li><a class="tocitem" href="../../../initialconditions/samplingmethods/metropolishastings/">Thermal Metropolis-Hastings Monte Carlo</a></li></ul></li><li><span class="tocitem">Dynamics simulations</span><ul><li><a class="tocitem" href="../../../dynamicssimulations/dynamicssimulations/">Introduction</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/classical/">Classical molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/ehrenfest/">Ehrenfest molecular dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/fssh/">Fewest-switches surface hopping (FSSH)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/langevin/">Classical Langevin dynamics</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/mdef/">Molecular dynamics with electronic friction (MDEF)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/nrpmd/">Nonadiabatic ring polymer molecular dynamics (NRPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpmd/">Ring polymer molecular dynamics (RPMD)</a></li><li><a class="tocitem" href="../../../dynamicssimulations/dynamicsmethods/rpsh/">Ring polymer surface hopping (RPSH)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/reactive_scattering/">Reactive scattering from a metal surface</a></li><li><a class="tocitem" href="../../../examples/spinboson/">Ohmic spin-boson nonequilibrium population dynamics</a></li><li><a class="tocitem" href="../../../examples/threestatemorse/">Time-dependent populations with the ThreeStateMorse model</a></li><li><a class="tocitem" href="../../../examples/tully_scattering/">Scattering probabilities for TullyModelTwo</a></li></ul></li><li><span class="tocitem">Developer documentation</span><ul><li><a class="tocitem" href="../../../devdocs/diffeq/">DifferentialEquations.jl integration</a></li><li><a class="tocitem" href="../../../devdocs/models/">Implementing a new model</a></li><li><a class="tocitem" href="../../../devdocs/new_methods/">Contributing a new method</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-11-1" type="checkbox"/><label class="tocitem" for="menuitem-11-1"><span class="docs-label">NQCBase</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCBase/nqcbase/">NQCBase</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-2" type="checkbox"/><label class="tocitem" for="menuitem-11-2"><span class="docs-label">NQCModels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../NQCModels/adiabaticmodels/">AdiabaticModels</a></li><li><a class="tocitem" href="../../NQCModels/cubeldfamodel/">CubeLDFAModel</a></li><li><a class="tocitem" href="../../NQCModels/diabaticmodels/">DiabaticModels</a></li><li><a class="tocitem" href="../../NQCModels/frictionmodels/">FrictionModels</a></li><li><a class="tocitem" href="../../NQCModels/nninterfaces/">NNInterfaces</a></li><li><a class="tocitem" href="../../NQCModels/nonadiabaticmodels/">NQCModels</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11-3" type="checkbox" checked/><label class="tocitem" for="menuitem-11-3"><span class="docs-label">NQCDynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calculators/">Calculators</a></li><li><a class="tocitem" href="../dynamicsmethods/">DynamicsMethods</a></li><li><a class="tocitem" href="../dynamicsoutputs/">DynamicsOutputs</a></li><li><a class="tocitem" href="../dynamicsutils/">DynamicsUtils</a></li><li><a class="tocitem" href="../ensembles/">Ensembles</a></li><li><a class="tocitem" href="../estimators/">Estimators</a></li><li class="is-active"><a class="tocitem" href>InitialConditions</a><ul class="internal"><li><a class="tocitem" href="#ThermalMonteCarlo"><span>ThermalMonteCarlo</span></a></li><li><a class="tocitem" href="#QuantisedDiatomic"><span>QuantisedDiatomic</span></a></li><li><a class="tocitem" href="#MetropolisHastings"><span>MetropolisHastings</span></a></li></ul></li><li><a class="tocitem" href="../nonadiabaticdistributions/">NonadiabaticDistributions</a></li><li><a class="tocitem" href="../nonadiabaticmoleculardynamics/">NQCDynamics</a></li><li><a class="tocitem" href="../ringpolymers/">RingPolymers</a></li><li><a class="tocitem" href="../timecorrelationfunctions/">TimeCorrelationFunctions</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">NQCDynamics</a></li><li class="is-active"><a href>InitialConditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>InitialConditions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NQCD/NQCDynamics.jl/blob/master/docs/src/api/NQCDynamics/initialconditions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="InitialConditions"><a class="docs-heading-anchor" href="#InitialConditions">InitialConditions</a><a id="InitialConditions-1"></a><a class="docs-heading-anchor-permalink" href="#InitialConditions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions" href="#NQCDynamics.InitialConditions"><code>NQCDynamics.InitialConditions</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">InitialConditions</code></pre><p>Functions and types for generating initial conditions for simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/InitialConditions.jl#L1-L5">source</a></section></article><h2 id="ThermalMonteCarlo"><a class="docs-heading-anchor" href="#ThermalMonteCarlo">ThermalMonteCarlo</a><a id="ThermalMonteCarlo-1"></a><a class="docs-heading-anchor-permalink" href="#ThermalMonteCarlo" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling-Tuple{Simulation, Any, Any}" href="#NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling-Tuple{Simulation, Any, Any}"><code>NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedhmc_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_advancedhmc_sampling(sim::Simulation, r, n_samples;
    target_acceptance=0.5, kwargs...)</code></pre><p>Perform Hamiltonian Monte Carlo sampling for the simulation <code>sim</code> using <code>AdvancedHMC.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/ThermalMonteCarlo.jl#L193-L198">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling-Tuple{NQCDynamics.AbstractSimulation, Any, Real, Dict{Symbol, &lt;:Real}}" href="#NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling-Tuple{NQCDynamics.AbstractSimulation, Any, Real, Dict{Symbol, &lt;:Real}}"><code>NQCDynamics.InitialConditions.ThermalMonteCarlo.run_advancedmh_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_advancedhmc_sampling(sim, r, steps, σ; move_ratio=0.0, internal_ratio=0.0)</code></pre><p>Sample the configuration space for the simulation <code>sim</code> starting from <code>r</code>.</p><p>Total number of steps is given by <code>steps</code> and <code>σ</code> is the dictionary of step sizes for each species.</p><p><code>move_ratio</code> defaults to <code>0.0</code> and denotes the fraction of system moved each step. If <code>move_ratio = 0</code>, every degree of freedom is moved at each step. If <code>move_ratio = 1</code>, then nothing will happen. Experiment with this parameter to achieve optimal sampling.</p><p><code>internal_ratio</code> works as for <code>move_ratio</code> but for the internal modes of the ring polymer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/ThermalMonteCarlo.jl#L27-L41">source</a></section></article><h2 id="QuantisedDiatomic"><a class="docs-heading-anchor" href="#QuantisedDiatomic">QuantisedDiatomic</a><a id="QuantisedDiatomic-1"></a><a class="docs-heading-anchor-permalink" href="#QuantisedDiatomic" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic" href="#NQCDynamics.InitialConditions.QuantisedDiatomic"><code>NQCDynamics.InitialConditions.QuantisedDiatomic</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">QuantisedDiatomic</code></pre><p>This module exports two user facing functions:</p><ul><li><p><code>generate_configurations</code>   Creates a set of velocities and positions for diatomic molecule with specified   vibrational <code>ν</code> and rotational <code>J</code> quantum numbers.</p></li><li><p><code>quantise_diatomic</code>   Obtains vibrational <code>ν</code> and rotational <code>J</code> quantum numbers for a diatomic molecule   with a given set of velocities and positions.</p></li></ul><p>The central concept of this module is the EBK procedure which is nicely detailed here: <a href="../../../references/#Larkoski2006">Andrew J. Larkoski, David G. Ellis, Lorenzo J. Curtis (2006)</a></p><p>Inspired by VENUS96: <a href="../../../references/#Hase1996">William L Hase, Ronald J Duchovic, Xiche Hu, Andrew Komornicki, Kieran F Lim, Da-hong Lu, Gilles H Peslherbe, Kandadai N Swamy, SR Vande Linde, Antonio Varandas, others (1996)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!-Tuple{Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!-Tuple{Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.apply_random_rotation!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Randomly rotate each column of two 3*N matrix, same rotation for all columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L335-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy-Tuple{NQCModels.AdiabaticModels.AdiabaticModel, Real, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy-Tuple{NQCModels.AdiabaticModels.AdiabaticModel, Real, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_diatomic_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calculate_diatomic_energy(model::AdiabaticModel, bond_length::Real;
    height=10, normal_vector=[0, 0, 1])</code></pre><p>Returns potential energy of diatomic with <code>bond_length</code> at <code>height</code> from surface.</p><p>Orients molecule parallel to the surface at the specified height, the surface is assumed to intersect the origin. This requires that the model implicitly provides the surface, or works fine without one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L370-L379">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_force_constant-Tuple{Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_force_constant-Tuple{Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.calculate_force_constant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calculate_force_constant(sim::Simulation, surface::SurfaceParameters)</code></pre><p>Evaluate energy for different bond lengths and identify force constant. </p><p>This uses LsqFit.jl to fit a morse potential with optimised minimum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L391-L397">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.combine_slab_and_molecule</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">combine_slab_and_molecule(atom_indices, molecule, slab)</code></pre><p>Revert the transformation <code>separate_slab_and_molecule</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic-Tuple{Any, Any, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters, NQCDynamics.InitialConditions.QuantisedDiatomic.GenerationParameters}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic-Tuple{Any, Any, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters, NQCDynamics.InitialConditions.QuantisedDiatomic.GenerationParameters}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.configure_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Randomly orient molecule in space for a given bond length and radial momentum</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L309-L311">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy-Tuple{NQCModels.AdiabaticModels.AdiabaticModel, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy-Tuple{NQCModels.AdiabaticModels.AdiabaticModel, Any, Any, NQCDynamics.InitialConditions.QuantisedDiatomic.SurfaceParameters}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.find_total_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">find_total_energy(sim, ν, J, surface)</code></pre><p>Returns the energy associated with the specified quantum numbers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L137-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.generate_configurations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_configurations(sim, ν, J; samples=1000, height=10, normal_vector=[0, 0, 1],
    translational_energy=0, direction=[0, 0, -1], position=[0, 0, height])</code></pre><p>Generate positions and momenta for given quantum numbers</p><p><code>translational_energy</code>, <code>direction</code> and <code>position</code> specify the kinetic energy in a specific direction with the molecule placed with centre of mass at <code>position</code>.</p><p>Keyword arguments <code>height</code> and <code>normal_vector</code> become relevant if the potential requires specific placement of the molecule. These allow the molecule to be placed at a distance <code>height</code> in the direction <code>normal_vector</code> when performing potential evaluations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L72-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic-Tuple{Simulation, Matrix, Matrix}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.quantise_diatomic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">quantise_diatomic(sim::Simulation, v::Matrix, r::Matrix;
    height=10, normal_vector=[0, 0, 1])</code></pre><p>Quantise the vibrational and rotational degrees of freedom for the specified positions and velocities</p><p>When evaluating the potential, the molecule is moved to <code>height</code> in direction <code>normal_vector</code>. If the potential is independent of centre of mass position, this has no effect. Otherwise, be sure to modify these parameters to give the intended behaviour.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L209-L219">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths-Tuple{Any, Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths-Tuple{Any, Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.select_random_bond_lengths</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Pick a random bond length and corresponding radial momentum that matches the radial probability distribution.</p><p>Uses rejection sampling: https://en.wikipedia.org/wiki/Rejection_sampling</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L281-L286">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule-Tuple{Any, Any}" href="#NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule-Tuple{Any, Any}"><code>NQCDynamics.InitialConditions.QuantisedDiatomic.separate_slab_and_molecule</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">separate_slab_and_molecule(atom_indices, r)</code></pre><p>Get the coordinates of the molecule and slab separately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/QuantisedDiatomic.jl#L108-L112">source</a></section></article><h2 id="MetropolisHastings"><a class="docs-heading-anchor" href="#MetropolisHastings">MetropolisHastings</a><a id="MetropolisHastings-1"></a><a class="docs-heading-anchor-permalink" href="#MetropolisHastings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings" href="#NQCDynamics.InitialConditions.MetropolisHastings"><code>NQCDynamics.InitialConditions.MetropolisHastings</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">MetropolisHastings</code></pre><p>Sampling of the initial conditions using the Metropolis-Hastings Markov chain Monte Carlo method.</p><p>Included within is the ability to sample the canonical distribution for adiabatic classical and ring polymer systems.</p><p>Usage involves creating an instance of an <code>AbstractSystem{MonteCarlo}</code> and calling <code>run_monte_carlo_sampling</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo" href="#NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo"><code>NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameters for Monte carlo simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L34-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput" href="#NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput"><code>NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Container for storing simulation quantities</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L83-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo}" href="#NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo}"><code>NQCDynamics.InitialConditions.MetropolisHastings.acceptance_probability</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">acceptance_probability(system::AbstractSystem{MonteCarlo})</code></pre><p>Return the Metropolis-Hastings acceptance probability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L269-L273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!-Tuple{Atoms, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, AbstractMatrix, Integer, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!-Tuple{Atoms, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, AbstractMatrix, Integer, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.apply_random_perturbation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">apply_random_perturbation!(system::AbstractSystem{MonteCarlo}, R::AbstractMatrix, atom::Integer)</code></pre><p>Randomly perturb the xyz coordinates of a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L222-L226">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!-Tuple{NQCDynamics.AbstractSimulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, Any, Any, Any, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!-Tuple{NQCDynamics.AbstractSimulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloParameters, Any, Any, Any, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.assess_proposal!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assess_proposal!(system::AbstractSystem{MonteCarlo}, Rᵢ, Rₚ, output, i)</code></pre><p>Update the energy, check for acceptance, and update the output. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L251-L255">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T&lt;:AbstractFloat" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T&lt;:AbstractFloat"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_centroid_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_centroid_move!(system::RingPolymerSystem{MonteCarlo}, Rᵢ::Array{T, 3}, Rₚ::Array{T, 3}) where {T&lt;:AbstractFloat}</code></pre><p>Propose a move for the ring polymer centroid for one atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_move!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, Integer}" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_move!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, Integer}"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_move!(system::System{MonteCarlo}, Rᵢ::Matrix{T}, Rₚ::Matrix{T}) where {T&lt;:AbstractFloat}</code></pre><p>Propose simple cartesian move for a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L195-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, Integer}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.propose_normal_mode_move!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propose_normal_mode_move!(system::RingPolymerSystem{MonteCarlo}, Rᵢ::Array{T, 3}, Rₚ::Array{T, 3}) where {T}</code></pre><p>Propose a move for a single normal mode for a single atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L231-L235">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Tuple{Simulation, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarlo, Matrix, Matrix, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_main_loop!(system::System{MonteCarlo}, Rᵢ::Matrix, Rₚ::Matrix, output::MonteCarloOutput)</code></pre><p>Main loop for classical systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L146-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!-Union{Tuple{T}, Tuple{RingPolymerSimulation, NQCDynamics.InitialConditions.MetropolisHastings.PathIntegralMonteCarlo, Array{T, 3}, Array{T, 3}, NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_main_loop!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Main loop for ring polymer systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L164-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling-Union{Tuple{T}, Tuple{Simulation, Matrix{T}, Dict{Symbol, T}, Real}} where T" href="#NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling-Union{Tuple{T}, Tuple{Simulation, Matrix{T}, Dict{Symbol, T}, Real}} where T"><code>NQCDynamics.InitialConditions.MetropolisHastings.run_monte_carlo_sampling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_monte_carlo_sampling(sim::AbstractSimulation, monte::MonteCarloParameters, R0)</code></pre><p>Perform Monte Carlo sampling for the system defined by the <code>sim</code> and <code>monte</code> parameters.</p><p>From the initial positions specified <code>R0</code> the system will be explored using the Metropolis-Hastings algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L103-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NQCDynamics.InitialConditions.MetropolisHastings.write_output!-Tuple{NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput, AbstractArray, AbstractFloat}" href="#NQCDynamics.InitialConditions.MetropolisHastings.write_output!-Tuple{NQCDynamics.InitialConditions.MetropolisHastings.MonteCarloOutput, AbstractArray, AbstractFloat}"><code>NQCDynamics.InitialConditions.MetropolisHastings.write_output!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_output!(output::MonteCarloOutput, Rᵢ::AbstractArray, energy::AbstractFloat, i::Integer)</code></pre><p>Store the current configuration and associated energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NQCD/NQCDynamics.jl/blob/f829b89dc03bf0eac309cc568abc47d47828db90/src/InitialConditions/MetropolisHastings.jl#L282-L286">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../estimators/">« Estimators</a><a class="docs-footer-nextpage" href="../nonadiabaticdistributions/">NonadiabaticDistributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Tuesday 22 March 2022 10:49">Tuesday 22 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
